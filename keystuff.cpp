#include "F18.h"
#include <dsound.h>

#include "3dfxF18.h"
#include "keystuff.h"
#include "keysmsg.h"

#ifdef __DEMO__
#define REGKEY_CONFIG		"Software\\Jane's Combat Simulations\\F18 Demo\\Config"
#else
#define REGKEY_CONFIG		"Software\\Jane's Combat Simulations\\F18\\Config"
#endif

#define REGKEY_KEYLAYOUT	"Key Layout"
#define REGKEY_KEYPLAYSTYLE	"Playstyle"

static void _cleanup_string(char *szString);

ENDGAMERESONSE dwPlayerEndGameResponse;
KEYBOARDMAP	*gpLastMap;
KEYLAYOUT *gpCurrentLayout;
static KEYLAYOUT keyLayout;
char *pszOverridePath = NULL;

static BOOL gbKeySystemActive = TRUE;
BOOL GotExecutedKey = TRUE;

extern int XmitChannel;

//
// friendly name key lookups
//

VKLOOKUP vkLookup_fre[] = {
//
// Regular keys mappings
//
	{NULL,					"KEY_BACKSPACE",		VK_BACK,			LOOKF_KEYSTROKE,		0,			0},
	{NULL,					"KEY_TAB",				VK_TAB,				LOOKF_KEYSTROKE,		1,			0},
	{NULL,					"KEY_RETURN",			VK_RETURN,			LOOKF_KEYSTROKE,		2,			0},
	{NULL,					"KEY_ENTER",			VK_RETURN,			LOOKF_KEYSTROKE,		2,			0},
	{NULL,					"KEY_CAPS",				VK_CAPITAL,			LOOKF_KEYSTROKE,		5,			0},
	{NULL,					"KEY_SPACE",			VK_SPACE,			LOOKF_KEYSTROKE,		6,			0},
	{NULL,					"KEY_SPACEBAR",			VK_SPACE,			LOOKF_KEYSTROKE,		6,			0},
	{NULL,					"KEY_PGUP",				VK_PRIOR,			LOOKF_KEYSTROKE,		7,			0},
	{NULL,					"KEY_PAGEUP",			VK_PRIOR,			LOOKF_KEYSTROKE,		7,			0},
	{NULL,					"KEY_PGDN",				VK_NEXT,			LOOKF_KEYSTROKE,		8,			0},
	{NULL,					"KEY_PAGEDOWN",			VK_NEXT,			LOOKF_KEYSTROKE,		8,			0},
	{NULL,					"KEY_HOME",				VK_HOME,			LOOKF_KEYSTROKE,		9,			0},
	{NULL,					"KEY_END",				VK_END,				LOOKF_KEYSTROKE,		10,			0},
	{NULL,					"KEY_LEFT",				VK_LEFT,			LOOKF_KEYSTROKE,		11,			0},
	{NULL,					"KEY_UP",				VK_UP,				LOOKF_KEYSTROKE,		12,			0},
	{NULL,					"KEY_RIGHT",			VK_RIGHT,			LOOKF_KEYSTROKE,		13,			0},
	{NULL,					"KEY_DOWN",				VK_DOWN,			LOOKF_KEYSTROKE,		14,			0},
	{NULL,					"KEY_INS",				VK_INSERT,			LOOKF_KEYSTROKE,		15,			0},
	{NULL,					"KEY_INSERT",			VK_INSERT,			LOOKF_KEYSTROKE,		15,			0},
	{NULL,					"KEY_DEL",				VK_DELETE,			LOOKF_KEYSTROKE,		16,			0},
	{NULL,					"KEY_DELETE",			VK_DELETE,			LOOKF_KEYSTROKE,		16,			0},
	{NULL,					"KEY_APPS",				VK_APPS,			LOOKF_KEYSTROKE,		19,			0},
	{NULL,					"KEY_NUMPAD0",			VK_NUMPAD0,			LOOKF_KEYSTROKE,		20,			0},
	{NULL,					"KEY_NUMPAD1",			VK_NUMPAD1,			LOOKF_KEYSTROKE,		21,			0},
	{NULL,					"KEY_NUMPAD2",			VK_NUMPAD2,			LOOKF_KEYSTROKE,		22,			0},
	{NULL,					"KEY_NUMPAD3",			VK_NUMPAD3,			LOOKF_KEYSTROKE,		23,			0},
	{NULL,					"KEY_NUMPAD4",			VK_NUMPAD4,			LOOKF_KEYSTROKE,		24,			0},
	{NULL,					"KEY_NUMPAD5",			VK_NUMPAD5,			LOOKF_KEYSTROKE,		25,			0},
	{NULL,					"KEY_NUMPAD6",			VK_NUMPAD6,			LOOKF_KEYSTROKE,		26,			0},
	{NULL,					"KEY_NUMPAD7",			VK_NUMPAD7,			LOOKF_KEYSTROKE,		27,			0},
	{NULL,					"KEY_NUMPAD8",			VK_NUMPAD8,			LOOKF_KEYSTROKE,		28,			0},
	{NULL,					"KEY_NUMPAD9",			VK_NUMPAD9,			LOOKF_KEYSTROKE,		29,			0},
	{NULL,					"KEY_MULTIPLY",			VK_MULTIPLY,		LOOKF_KEYSTROKE,		30,			0},
	{NULL,					"KEY_ADD",				VK_ADD,				LOOKF_KEYSTROKE,		31,			0},
	{NULL,					"KEY_SUBTRACT",			VK_SUBTRACT,		LOOKF_KEYSTROKE,		32,			0},
	{NULL,					"KEY_SUB",				VK_SUBTRACT,		LOOKF_KEYSTROKE,		32,			0},
	{NULL,					"KEY_DECIMAL",			VK_DECIMAL,			LOOKF_KEYSTROKE,		33,			0},
	{NULL,					"KEY_DIVIDE",			VK_DIVIDE,			LOOKF_KEYSTROKE,		34,			0},
	{"KEY_F01",				"KEY_F1",				VK_F1,				LOOKF_KEYSTROKE,		35,			0},
	{"KEY_F02",				"KEY_F2",				VK_F2,				LOOKF_KEYSTROKE,		36,			0},
	{"KEY_F03",				"KEY_F3",				VK_F3,				LOOKF_KEYSTROKE,		37,			0},
	{"KEY_F04",				"KEY_F4",				VK_F4,				LOOKF_KEYSTROKE,		38,			0},
	{"KEY_F05",				"KEY_F5",				VK_F5,				LOOKF_KEYSTROKE,		39,			0},
	{"KEY_F06",				"KEY_F6",				VK_F6,				LOOKF_KEYSTROKE,		40,			0},
	{"KEY_F07",				"KEY_F7",				VK_F7,				LOOKF_KEYSTROKE,		41,			0},
	{"KEY_F08",				"KEY_F8",				VK_F8,				LOOKF_KEYSTROKE,		42,			0},
	{"KEY_F09",				"KEY_F9",				VK_F9,				LOOKF_KEYSTROKE,		43,			0},
	{NULL,					"KEY_F10",				VK_F10,				LOOKF_KEYSTROKE,		44,			0},
	{NULL,					"KEY_F11",				VK_F11,				LOOKF_KEYSTROKE,		45,			0},
	{NULL,					"KEY_F12",				VK_F12,				LOOKF_KEYSTROKE,		46,			0},
	{NULL,					"KEY_NUMLOCK",			VK_NUMLOCK,			LOOKF_KEYSTROKE,		47,			0},
	{NULL,					"KEY_SCROLL",			VK_SCROLL,			LOOKF_KEYSTROKE,		48,			0},
	{NULL,					"KEY_0",				'0',				LOOKF_KEYSTROKE,		49,			0},
	{NULL,					"KEY_1",				'1',				LOOKF_KEYSTROKE,		50,			0},
	{NULL,					"KEY_2",				'2',				LOOKF_KEYSTROKE,		51,			0},
	{NULL,					"KEY_3",				'3',				LOOKF_KEYSTROKE,		52,			0},
	{NULL,					"KEY_4",				'4',				LOOKF_KEYSTROKE,		53,			0},
	{NULL,					"KEY_5",				'5',				LOOKF_KEYSTROKE,		54,			0},
	{NULL,					"KEY_6",				'6',				LOOKF_KEYSTROKE,		55,			0},
	{NULL,					"KEY_7",				'7',				LOOKF_KEYSTROKE,		56,			0},
	{NULL,					"KEY_8",				'8',				LOOKF_KEYSTROKE,		57,			0},
	{NULL,					"KEY_9",				'9',				LOOKF_KEYSTROKE,		58,			0},
	{NULL,					"KEY_A",				VK_A_FR,			LOOKF_KEYSTROKE,		59,			0},
	{NULL,					"KEY_B",				VK_B_FR,			LOOKF_KEYSTROKE,		60,			0},
	{NULL,					"KEY_C",				VK_C_FR,			LOOKF_KEYSTROKE,		61,			0},
	{NULL,					"KEY_D",				VK_D_FR,			LOOKF_KEYSTROKE,		62,			0},
	{NULL,					"KEY_E",				VK_E_FR,			LOOKF_KEYSTROKE,		63,			0},
	{NULL,					"KEY_F",				VK_F_FR,			LOOKF_KEYSTROKE,		64,			0},
	{NULL,					"KEY_G",				VK_G_FR,			LOOKF_KEYSTROKE,		65,			0},
	{NULL,					"KEY_H",				VK_H_FR,			LOOKF_KEYSTROKE,		66,			0},
	{NULL,					"KEY_I",				VK_I_FR,			LOOKF_KEYSTROKE,		67,			0},
	{NULL,					"KEY_J",				VK_J_FR,			LOOKF_KEYSTROKE,		68,			0},
	{NULL,					"KEY_K",				VK_K_FR,			LOOKF_KEYSTROKE,		69,			0},
	{NULL,					"KEY_L",				VK_L_FR,			LOOKF_KEYSTROKE,		70,			0},
	{NULL,					"KEY_M",				VK_M_FR,			LOOKF_KEYSTROKE,		71,			0},
	{NULL,					"KEY_N",				VK_N_FR,			LOOKF_KEYSTROKE,		72,			0},
	{NULL,					"KEY_O",				VK_O_FR,			LOOKF_KEYSTROKE,		73,			0},
	{NULL,					"KEY_P",				VK_P_FR,			LOOKF_KEYSTROKE,		74,			0},
	{NULL,					"KEY_Q",				VK_Q_FR,			LOOKF_KEYSTROKE,		75,			0},
	{NULL,					"KEY_R",				VK_R_FR,			LOOKF_KEYSTROKE,		76,			0},
	{NULL,					"KEY_S",				VK_S_FR,			LOOKF_KEYSTROKE,		77,			0},
	{NULL,					"KEY_T",				VK_T_FR,			LOOKF_KEYSTROKE,		78,			0},
	{NULL,					"KEY_U",				VK_U_FR,			LOOKF_KEYSTROKE,		79,			0},
	{NULL,					"KEY_V",				VK_V_FR,			LOOKF_KEYSTROKE,		80,			0},
	{NULL,					"KEY_W",				VK_W_FR,			LOOKF_KEYSTROKE,		81,			0},
	{NULL,					"KEY_X",				VK_X_FR,			LOOKF_KEYSTROKE,		82,			0},
	{NULL,					"KEY_Y",				VK_Y_FR,			LOOKF_KEYSTROKE,		83,			0},
	{NULL,					"KEY_Z",				VK_Z_FR,			LOOKF_KEYSTROKE,		84,			0},
	{"JOY1_BUTTON01",		"JOY1_BUTTON1",			JOY_BUTTON1,		LOOKF_JOY1,				85,			0},
	{"JOY1_BUTTON02",		"JOY1_BUTTON2",			JOY_BUTTON2,		LOOKF_JOY1,				86,			0},
	{"JOY1_BUTTON03",		"JOY1_BUTTON3",			JOY_BUTTON3,		LOOKF_JOY1,				87,			0},
	{"JOY1_BUTTON04",		"JOY1_BUTTON4",			JOY_BUTTON4,		LOOKF_JOY1,				88,			0},
	{"JOY1_BUTTON05",		"JOY1_BUTTON5",			JOY_BUTTON5,		LOOKF_JOY1,				89,			0},
	{"JOY1_BUTTON06",		"JOY1_BUTTON6",			JOY_BUTTON6,		LOOKF_JOY1,				90,			0},
	{"JOY1_BUTTON07",		"JOY1_BUTTON7",			JOY_BUTTON7,		LOOKF_JOY1,				91,			0},
	{"JOY1_BUTTON08",		"JOY1_BUTTON8",			JOY_BUTTON8,		LOOKF_JOY1,				92,			0},
	{"JOY1_BUTTON09",		"JOY1_BUTTON9",			JOY_BUTTON9,		LOOKF_JOY1,				93,			0},
	{NULL,					"JOY1_BUTTON10",		JOY_BUTTON10,		LOOKF_JOY1,				94,			0},
	{NULL,					"JOY1_BUTTON11",		JOY_BUTTON11,		LOOKF_JOY1,				95,			0},
	{NULL,					"JOY1_BUTTON12",		JOY_BUTTON12,		LOOKF_JOY1,				96,			0},
	{NULL,					"JOY1_BUTTON13",		JOY_BUTTON13,		LOOKF_JOY1,				97,			0},
	{NULL,					"JOY1_BUTTON14",		JOY_BUTTON14,		LOOKF_JOY1,				98,			0},
	{NULL,					"JOY1_BUTTON15",		JOY_BUTTON15,		LOOKF_JOY1,				99,			0},
	{NULL,					"JOY1_BUTTON16",		JOY_BUTTON16,		LOOKF_JOY1,				100,		0},
	{"JOY2_BUTTON01",		"JOY2_BUTTON1",			JOY_BUTTON1,		LOOKF_JOY2,				101,		0},
	{"JOY2_BUTTON02",		"JOY2_BUTTON2",			JOY_BUTTON2,		LOOKF_JOY2,				102,		0},
	{"JOY2_BUTTON03",		"JOY2_BUTTON3",			JOY_BUTTON3,		LOOKF_JOY2,				103,		0},
	{"JOY2_BUTTON04",		"JOY2_BUTTON4",			JOY_BUTTON4,		LOOKF_JOY2,				104,		0},
	{"JOY2_BUTTON05",		"JOY2_BUTTON5",			JOY_BUTTON5,		LOOKF_JOY2,				105,		0},
	{"JOY2_BUTTON06",		"JOY2_BUTTON6",			JOY_BUTTON6,		LOOKF_JOY2,				106,		0},
	{"JOY2_BUTTON07",		"JOY2_BUTTON7",			JOY_BUTTON7,		LOOKF_JOY2,				107,		0},
	{"JOY2_BUTTON08",		"JOY2_BUTTON8",			JOY_BUTTON8,		LOOKF_JOY2,				108,		0},
	{"JOY2_BUTTON09",		"JOY2_BUTTON9",			JOY_BUTTON9,		LOOKF_JOY2,				109,		0},
	{NULL,					"JOY2_BUTTON10",		JOY_BUTTON10,		LOOKF_JOY2,				110,		0},
	{NULL,					"JOY2_BUTTON11",		JOY_BUTTON11,		LOOKF_JOY2,				111,		0},
	{NULL,					"JOY2_BUTTON12",		JOY_BUTTON12,		LOOKF_JOY2,				112,		0},
	{NULL,					"JOY2_BUTTON13",		JOY_BUTTON13,		LOOKF_JOY2,				113,		0},
	{NULL,					"JOY2_BUTTON14",		JOY_BUTTON14,		LOOKF_JOY2,				114,		0},
	{NULL,					"JOY2_BUTTON15",		JOY_BUTTON15,		LOOKF_JOY2,				115,		0},
	{NULL,					"JOY2_BUTTON16",		JOY_BUTTON16,		LOOKF_JOY2,				116,		0},
	{NULL,					"JOY1_HATUP",			JOY_POVFORWARD,		LOOKF_JOYHAT1,			117,		0},
	{NULL,					"JOY1_HATRIGHT",		JOY_POVRIGHT,		LOOKF_JOYHAT1,			118,		0},
	{NULL,					"JOY1_HATDOWN",			JOY_POVBACKWARD,	LOOKF_JOYHAT1,			119,		0},
	{NULL,					"JOY1_HATLEFT",			JOY_POVLEFT,		LOOKF_JOYHAT1,			120,		0},
	{NULL,					"JOY2_HATUP",			JOY_POVFORWARD,		LOOKF_JOYHAT2,			121,		0},
	{NULL,					"JOY2_HATRIGHT",		JOY_POVRIGHT,		LOOKF_JOYHAT2,			122,		0},
	{NULL,					"JOY2_HATDOWN",			JOY_POVBACKWARD,	LOOKF_JOYHAT2,			123,		0},
	{NULL,					"JOY2_HATLEFT",			JOY_POVLEFT,		LOOKF_JOYHAT2,			124,		0},
	{NULL,					"KEY_TWO",				VK_TWO_FR,			LOOKF_KEYSTROKE,		139,		0},
	{NULL,					"KEY_COMMA",			VK_COMMA_FR,		LOOKF_KEYSTROKE,		127,		0},
	{NULL,					"KEY_ACCENTU",			VK_ACCENTU_FR,		LOOKF_KEYSTROKE,		133,		0},
	{NULL,					"KEY_SEMICOLON",		VK_SEMICOLON_FR,	LOOKF_KEYSTROKE,		125,		0},
	{NULL,					"KEY_COLON",			VK_COLON_FR,		LOOKF_KEYSTROKE,		134,		0},
	{NULL,					"KEY_EXCLAMATION",		VK_EXCLAMATION_FR,	LOOKF_KEYSTROKE,		135,		0},
	{NULL,					"KEY_CARROT",			VK_CARROT_FR,		LOOKF_KEYSTROKE,		136,		0},
	{NULL,					"KEY_DOLLAR",			VK_DOLLAR_FR,		LOOKF_KEYSTROKE,		137,		0},
	{NULL,					"KEY_RPARENTHES",		VK_RPARENTHES_FR,	LOOKF_KEYSTROKE,		138,		0},
	{NULL,					"KEY_EQUAL",			VK_EQUAL_FR,		LOOKF_KEYSTROKE,		126,		0},
	{NULL,					"KEY_LESSTHAN",			VK_LESSTHAN_FR,		LOOKF_KEYSTROKE,		145,		0},
	{NULL,					"KEY_ASTERIK",			VK_ASTERIK_FR,		LOOKF_KEYSTROKE,		30,			0},

//
// CTRL keys mappings
//
	{NULL,					"KEY_CTRL_BKSPC",		VK_BACK,			LOOKF_KEYSTROKE,		0,			VK_CONTROL},
	{NULL,					"KEY_CTRL_TAB",			VK_TAB,				LOOKF_KEYSTROKE,		1,			VK_CONTROL},
	{NULL,					"KEY_CTRL_RETURN",		VK_RETURN,			LOOKF_KEYSTROKE,		2,			VK_CONTROL},
	{NULL,					"KEY_CTRL_ENTER",		VK_RETURN,			LOOKF_KEYSTROKE,		2,			VK_CONTROL},
	{NULL,					"KEY_CTRL_SPACE",		VK_SPACE,			LOOKF_KEYSTROKE,		6,			VK_CONTROL},
	{NULL,					"KEY_CTRL_SPACEBAR",	VK_SPACE,			LOOKF_KEYSTROKE,		6,			VK_CONTROL},
	{NULL,					"KEY_CTRL_PGUP",		VK_PRIOR,			LOOKF_KEYSTROKE,		7,			VK_CONTROL},
	{NULL,					"KEY_CTRL_PAGEUP",		VK_PRIOR,			LOOKF_KEYSTROKE,		7,			VK_CONTROL},
	{NULL,					"KEY_CTRL_PGDN",		VK_NEXT,			LOOKF_KEYSTROKE,		8,			VK_CONTROL},
	{NULL,					"KEY_CTRL_PAGEDOWN",	VK_NEXT,			LOOKF_KEYSTROKE,		8,			VK_CONTROL},
	{NULL,					"KEY_CTRL_HOME",		VK_HOME,			LOOKF_KEYSTROKE,		9,			VK_CONTROL},
	{NULL,					"KEY_CTRL_END",			VK_END,				LOOKF_KEYSTROKE,		10,			VK_CONTROL},
	{NULL,					"KEY_CTRL_LEFT",		VK_LEFT,			LOOKF_KEYSTROKE,		11,			VK_CONTROL},
	{NULL,					"KEY_CTRL_UP",			VK_UP,				LOOKF_KEYSTROKE,		12,			VK_CONTROL},
	{NULL,					"KEY_CTRL_RIGHT",		VK_RIGHT,			LOOKF_KEYSTROKE,		13,			VK_CONTROL},
	{NULL,					"KEY_CTRL_DOWN",		VK_DOWN,			LOOKF_KEYSTROKE,		14,			VK_CONTROL},
	{NULL,					"KEY_CTRL_INS",			VK_INSERT,			LOOKF_KEYSTROKE,		15,			VK_CONTROL},
	{NULL,					"KEY_CTRL_INSERT",		VK_INSERT,			LOOKF_KEYSTROKE,		15,			VK_CONTROL},
	{NULL,					"KEY_CTRL_DEL",			VK_DELETE,			LOOKF_KEYSTROKE,		16,			VK_CONTROL},
	{NULL,					"KEY_CTRL_DELETE",		VK_DELETE,			LOOKF_KEYSTROKE,		16,			VK_CONTROL},
	{NULL,					"KEY_CTRL_APPS",		VK_APPS,			LOOKF_KEYSTROKE,		19,			VK_CONTROL},
	{"KEY_CTRL_F01",		"KEY_CTRL_F1",			VK_F1,				LOOKF_KEYSTROKE,		35,			VK_CONTROL},
	{"KEY_CTRL_F02",		"KEY_CTRL_F2",			VK_F2,				LOOKF_KEYSTROKE,		36,			VK_CONTROL},
	{"KEY_CTRL_F03",		"KEY_CTRL_F3",			VK_F3,				LOOKF_KEYSTROKE,		37,			VK_CONTROL},
	{"KEY_CTRL_F04",		"KEY_CTRL_F4",			VK_F4,				LOOKF_KEYSTROKE,		38,			VK_CONTROL},
	{"KEY_CTRL_F05",		"KEY_CTRL_F5",			VK_F5,				LOOKF_KEYSTROKE,		39,			VK_CONTROL},
	{"KEY_CTRL_F06",		"KEY_CTRL_F6",			VK_F6,				LOOKF_KEYSTROKE,		40,			VK_CONTROL},
	{"KEY_CTRL_F07",		"KEY_CTRL_F7",			VK_F7,				LOOKF_KEYSTROKE,		41,			VK_CONTROL},
	{"KEY_CTRL_F08",		"KEY_CTRL_F8",			VK_F8,				LOOKF_KEYSTROKE,		42,			VK_CONTROL},
	{"KEY_CTRL_F09",		"KEY_CTRL_F9",			VK_F9,				LOOKF_KEYSTROKE,		43,			VK_CONTROL},
	{NULL,					"KEY_CTRL_F10",			VK_F10,				LOOKF_KEYSTROKE,		44,			VK_CONTROL},
	{NULL,					"KEY_CTRL_F11",			VK_F11,				LOOKF_KEYSTROKE,		45,			VK_CONTROL},
	{NULL,					"KEY_CTRL_F12",			VK_F12,				LOOKF_KEYSTROKE,		46,			VK_CONTROL},
	{NULL,					"KEY_CTRL_NUMLOCK",		VK_NUMLOCK,			LOOKF_KEYSTROKE,		47,			VK_CONTROL},
	{NULL,					"KEY_CTRL_SCROLL",		VK_SCROLL,			LOOKF_KEYSTROKE,		48,			VK_CONTROL},
	{NULL,					"KEY_CTRL_0",			'0',				LOOKF_KEYSTROKE,		49,			VK_CONTROL},
	{NULL,					"KEY_CTRL_1",			'1',				LOOKF_KEYSTROKE,		50,			VK_CONTROL},
	{NULL,					"KEY_CTRL_2",			'2',				LOOKF_KEYSTROKE,		51,			VK_CONTROL},
	{NULL,					"KEY_CTRL_3",			'3',				LOOKF_KEYSTROKE,		52,			VK_CONTROL},
	{NULL,					"KEY_CTRL_4",			'4',				LOOKF_KEYSTROKE,		53,			VK_CONTROL},
	{NULL,					"KEY_CTRL_5",			'5',				LOOKF_KEYSTROKE,		54,			VK_CONTROL},
	{NULL,					"KEY_CTRL_6",			'6',				LOOKF_KEYSTROKE,		55,			VK_CONTROL},
	{NULL,					"KEY_CTRL_7",			'7',				LOOKF_KEYSTROKE,		56,			VK_CONTROL},
	{NULL,					"KEY_CTRL_8",			'8',				LOOKF_KEYSTROKE,		57,			VK_CONTROL},
	{NULL,					"KEY_CTRL_9",			'9',				LOOKF_KEYSTROKE,		58,			VK_CONTROL},
	{NULL,					"KEY_CTRL_A",			VK_A_FR,			LOOKF_KEYSTROKE,		59,			VK_CONTROL},
	{NULL,					"KEY_CTRL_B",			VK_B_FR,			LOOKF_KEYSTROKE,		60,			VK_CONTROL},
	{NULL,					"KEY_CTRL_C",			VK_C_FR,			LOOKF_KEYSTROKE,		61,			VK_CONTROL},
	{NULL,					"KEY_CTRL_D",			VK_D_FR,			LOOKF_KEYSTROKE,		62,			VK_CONTROL},
	{NULL,					"KEY_CTRL_E",			VK_E_FR,			LOOKF_KEYSTROKE,		63,			VK_CONTROL},
	{NULL,					"KEY_CTRL_F",			VK_F_FR,			LOOKF_KEYSTROKE,		64,			VK_CONTROL},
	{NULL,					"KEY_CTRL_G",			VK_G_FR,			LOOKF_KEYSTROKE,		65,			VK_CONTROL},
	{NULL,					"KEY_CTRL_H",			VK_H_FR,			LOOKF_KEYSTROKE,		66,			VK_CONTROL},
	{NULL,					"KEY_CTRL_I",			VK_I_FR,			LOOKF_KEYSTROKE,		67,			VK_CONTROL},
	{NULL,					"KEY_CTRL_J",			VK_J_FR,			LOOKF_KEYSTROKE,		68,			VK_CONTROL},
	{NULL,					"KEY_CTRL_K",			VK_K_FR,			LOOKF_KEYSTROKE,		69,			VK_CONTROL},
	{NULL,					"KEY_CTRL_L",			VK_L_FR,			LOOKF_KEYSTROKE,		70,			VK_CONTROL},
	{NULL,					"KEY_CTRL_M",			VK_M_FR,			LOOKF_KEYSTROKE,		71,			VK_CONTROL},
	{NULL,					"KEY_CTRL_N",			VK_N_FR,			LOOKF_KEYSTROKE,		72,			VK_CONTROL},
	{NULL,					"KEY_CTRL_O",			VK_O_FR,			LOOKF_KEYSTROKE,		73,			VK_CONTROL},
	{NULL,					"KEY_CTRL_P",			VK_P_FR,			LOOKF_KEYSTROKE,		74,			VK_CONTROL},
	{NULL,					"KEY_CTRL_Q",			VK_Q_FR,			LOOKF_KEYSTROKE,		75,			VK_CONTROL},
	{NULL,					"KEY_CTRL_R",			VK_R_FR,			LOOKF_KEYSTROKE,		76,			VK_CONTROL},
	{NULL,					"KEY_CTRL_S",			VK_S_FR,			LOOKF_KEYSTROKE,		77,			VK_CONTROL},
	{NULL,					"KEY_CTRL_T",			VK_T_FR,			LOOKF_KEYSTROKE,		78,			VK_CONTROL},
	{NULL,					"KEY_CTRL_U",			VK_U_FR,			LOOKF_KEYSTROKE,		79,			VK_CONTROL},
	{NULL,					"KEY_CTRL_V",			VK_V_FR,			LOOKF_KEYSTROKE,		80,			VK_CONTROL},
	{NULL,					"KEY_CTRL_W",			VK_W_FR,			LOOKF_KEYSTROKE,		81,			VK_CONTROL},
	{NULL,					"KEY_CTRL_X",			VK_X_FR,			LOOKF_KEYSTROKE,		82,			VK_CONTROL},
	{NULL,					"KEY_CTRL_Y",			VK_Y_FR,			LOOKF_KEYSTROKE,		83,			VK_CONTROL},
	{NULL,					"KEY_CTRL_Z",			VK_Z_FR,			LOOKF_KEYSTROKE,		84,			VK_CONTROL},
	{NULL,					"KEY_CTRL_TWO",			VK_TWO_FR,			LOOKF_KEYSTROKE,		139,		VK_CONTROL},
	{NULL,					"KEY_CTRL_COMMA",		VK_COMMA_FR,		LOOKF_KEYSTROKE,		127,		VK_CONTROL},
	{NULL,					"KEY_CTRL_ACCENTU",		VK_ACCENTU_FR,		LOOKF_KEYSTROKE,		133,		VK_CONTROL},
	{NULL,					"KEY_CTRL_SEMICOLON",	VK_SEMICOLON_FR,	LOOKF_KEYSTROKE,		125,		VK_CONTROL},
	{NULL,					"KEY_CTRL_COLON",		VK_COLON_FR,		LOOKF_KEYSTROKE,		134,		VK_CONTROL},
	{NULL,					"KEY_CTRL_EXCLAMATION",	VK_EXCLAMATION_FR,	LOOKF_KEYSTROKE,		135,		VK_CONTROL},
	{NULL,					"KEY_CTRL_CARROT",		VK_CARROT_FR,		LOOKF_KEYSTROKE,		136,		VK_CONTROL},
	{NULL,					"KEY_CTRL_DOLLAR",		VK_DOLLAR_FR,		LOOKF_KEYSTROKE,		137,		VK_CONTROL},
	{NULL,					"KEY_CTRL_RPARENTHES",	VK_RPARENTHES_FR,	LOOKF_KEYSTROKE,		138,		VK_CONTROL},
	{NULL,					"KEY_CTRL_EQUAL",		VK_EQUAL_FR,		LOOKF_KEYSTROKE,		126,		VK_CONTROL},
	{NULL,					"KEY_CTRL_LESSTHAN",	VK_LESSTHAN_FR,		LOOKF_KEYSTROKE,		145,		VK_CONTROL},
	{NULL,					"KEY_CTRL_ASTERIK",		VK_ASTERIK_FR,		LOOKF_KEYSTROKE,		30,			VK_CONTROL},

//
// ALT keys mappings
//
	{NULL,					"KEY_ALT_BKSPC",		VK_BACK,			LOOKF_KEYSTROKE,		0,			VK_MENU},
	{NULL,					"KEY_ALT_TAB",			VK_TAB,				LOOKF_KEYSTROKE,		1,			VK_MENU},
	{NULL,					"KEY_ALT_RETURN",		VK_RETURN,			LOOKF_KEYSTROKE,		2,			VK_MENU},
	{NULL,					"KEY_ALT_ENTER",		VK_RETURN,			LOOKF_KEYSTROKE,		2,			VK_MENU},
	{NULL,					"KEY_ALT_SPACE",		VK_SPACE,			LOOKF_KEYSTROKE,		6,			VK_MENU},
	{NULL,					"KEY_ALT_SPACEBAR",		VK_SPACE,			LOOKF_KEYSTROKE,		6,			VK_MENU},
	{NULL,					"KEY_ALT_PGUP",			VK_PRIOR,			LOOKF_KEYSTROKE,		7,			VK_MENU},
	{NULL,					"KEY_ALT_PAGEUP",		VK_PRIOR,			LOOKF_KEYSTROKE,		7,			VK_MENU},
	{NULL,					"KEY_ALT_PGDN",			VK_NEXT,			LOOKF_KEYSTROKE,		8,			VK_MENU},
	{NULL,					"KEY_ALT_PAGEDOWN",		VK_NEXT,			LOOKF_KEYSTROKE,		8,			VK_MENU},
	{NULL,					"KEY_ALT_HOME",			VK_HOME,			LOOKF_KEYSTROKE,		9,			VK_MENU},
	{NULL,					"KEY_ALT_END",			VK_END,				LOOKF_KEYSTROKE,		10,			VK_MENU},
	{NULL,					"KEY_ALT_LEFT",			VK_LEFT,			LOOKF_KEYSTROKE,		11,			VK_MENU},
	{NULL,					"KEY_ALT_UP",			VK_UP,				LOOKF_KEYSTROKE,		12,			VK_MENU},
	{NULL,					"KEY_ALT_RIGHT",		VK_RIGHT,			LOOKF_KEYSTROKE,		13,			VK_MENU},
	{NULL,					"KEY_ALT_DOWN",			VK_DOWN,			LOOKF_KEYSTROKE,		14,			VK_MENU},
	{NULL,					"KEY_ALT_INS",			VK_INSERT,			LOOKF_KEYSTROKE,		15,			VK_MENU},
	{NULL,					"KEY_ALT_INSERT",		VK_INSERT,			LOOKF_KEYSTROKE,		15,			VK_MENU},
	{NULL,					"KEY_ALT_DEL",			VK_DELETE,			LOOKF_KEYSTROKE,		16,			VK_MENU},
	{NULL,					"KEY_ALT_DELETE",		VK_DELETE,			LOOKF_KEYSTROKE,		16,			VK_MENU},
	{NULL,					"KEY_ALT_APPS",			VK_APPS,			LOOKF_KEYSTROKE,		19,			VK_MENU},
	{"KEY_ALT_F01",			"KEY_ALT_F1",			VK_F1,				LOOKF_KEYSTROKE,		35,			VK_MENU},
	{"KEY_ALT_F02",			"KEY_ALT_F2",			VK_F2,				LOOKF_KEYSTROKE,		36,			VK_MENU},
	{"KEY_ALT_F03",			"KEY_ALT_F3",			VK_F3,				LOOKF_KEYSTROKE,		37,			VK_MENU},
	{"KEY_ALT_F04",			"KEY_ALT_F4",			VK_F4,				LOOKF_KEYSTROKE,		38,			VK_MENU},
	{"KEY_ALT_F05",			"KEY_ALT_F5",			VK_F5,				LOOKF_KEYSTROKE,		39,			VK_MENU},
	{"KEY_ALT_F06",			"KEY_ALT_F6",			VK_F6,				LOOKF_KEYSTROKE,		40,			VK_MENU},
	{"KEY_ALT_F07",			"KEY_ALT_F7",			VK_F7,				LOOKF_KEYSTROKE,		41,			VK_MENU},
	{"KEY_ALT_F08",			"KEY_ALT_F8",			VK_F8,				LOOKF_KEYSTROKE,		42,			VK_MENU},
	{"KEY_ALT_F09",			"KEY_ALT_F9",			VK_F9,				LOOKF_KEYSTROKE,		43,			VK_MENU},
	{NULL,					"KEY_ALT_F10",			VK_F10,				LOOKF_KEYSTROKE,		44,			VK_MENU},
	{NULL,					"KEY_ALT_F11",			VK_F11,				LOOKF_KEYSTROKE,		45,			VK_MENU},
	{NULL,					"KEY_ALT_F12",			VK_F12,				LOOKF_KEYSTROKE,		46,			VK_MENU},
	{NULL,					"KEY_ALT_NUMLOCK",		VK_NUMLOCK,			LOOKF_KEYSTROKE,		47,			VK_MENU},
	{NULL,					"KEY_ALT_SCROLL",		VK_SCROLL,			LOOKF_KEYSTROKE,		48,			VK_MENU},
	{NULL,					"KEY_ALT_0",			'0',				LOOKF_KEYSTROKE,		49,			VK_MENU},
	{NULL,					"KEY_ALT_1",			'1',				LOOKF_KEYSTROKE,		50,			VK_MENU},
	{NULL,					"KEY_ALT_2",			'2',				LOOKF_KEYSTROKE,		51,			VK_MENU},
	{NULL,					"KEY_ALT_3",			'3',				LOOKF_KEYSTROKE,		52,			VK_MENU},
	{NULL,					"KEY_ALT_4",			'4',				LOOKF_KEYSTROKE,		53,			VK_MENU},
	{NULL,					"KEY_ALT_5",			'5',				LOOKF_KEYSTROKE,		54,			VK_MENU},
	{NULL,					"KEY_ALT_6",			'6',				LOOKF_KEYSTROKE,		55,			VK_MENU},
	{NULL,					"KEY_ALT_7",			'7',				LOOKF_KEYSTROKE,		56,			VK_MENU},
	{NULL,					"KEY_ALT_8",			'8',				LOOKF_KEYSTROKE,		57,			VK_MENU},
	{NULL,					"KEY_ALT_9",			'9',				LOOKF_KEYSTROKE,		58,			VK_MENU},
	{NULL,					"KEY_ALT_A",			VK_A,				LOOKF_KEYSTROKE,		59,			VK_MENU},
	{NULL,					"KEY_ALT_B",			VK_B,				LOOKF_KEYSTROKE,		60,			VK_MENU},
	{NULL,					"KEY_ALT_C",			VK_C,				LOOKF_KEYSTROKE,		61,			VK_MENU},
	{NULL,					"KEY_ALT_D",			VK_D,				LOOKF_KEYSTROKE,		62,			VK_MENU},
	{NULL,					"KEY_ALT_E",			VK_E,				LOOKF_KEYSTROKE,		63,			VK_MENU},
	{NULL,					"KEY_ALT_F",			VK_F,				LOOKF_KEYSTROKE,		64,			VK_MENU},
	{NULL,					"KEY_ALT_G",			VK_G,				LOOKF_KEYSTROKE,		65,			VK_MENU},
	{NULL,					"KEY_ALT_H",			VK_H,				LOOKF_KEYSTROKE,		66,			VK_MENU},
	{NULL,					"KEY_ALT_I",			VK_I,				LOOKF_KEYSTROKE,		67,			VK_MENU},
	{NULL,					"KEY_ALT_J",			VK_J,				LOOKF_KEYSTROKE,		68,			VK_MENU},
	{NULL,					"KEY_ALT_K",			VK_K,				LOOKF_KEYSTROKE,		69,			VK_MENU},
	{NULL,					"KEY_ALT_L",			VK_L,				LOOKF_KEYSTROKE,		70,			VK_MENU},
	{NULL,					"KEY_ALT_M",			VK_M,				LOOKF_KEYSTROKE,		71,			VK_MENU},
	{NULL,					"KEY_ALT_N",			VK_N,				LOOKF_KEYSTROKE,		72,			VK_MENU},
	{NULL,					"KEY_ALT_O",			VK_O,				LOOKF_KEYSTROKE,		73,			VK_MENU},
	{NULL,					"KEY_ALT_P",			VK_P,				LOOKF_KEYSTROKE,		74,			VK_MENU},
	{NULL,					"KEY_ALT_Q",			VK_Q,				LOOKF_KEYSTROKE,		75,			VK_MENU},
	{NULL,					"KEY_ALT_R",			VK_R,				LOOKF_KEYSTROKE,		76,			VK_MENU},
	{NULL,					"KEY_ALT_S",			VK_S,				LOOKF_KEYSTROKE,		77,			VK_MENU},
	{NULL,					"KEY_ALT_T",			VK_T,				LOOKF_KEYSTROKE,		78,			VK_MENU},
	{NULL,					"KEY_ALT_U",			VK_U,				LOOKF_KEYSTROKE,		79,			VK_MENU},
	{NULL,					"KEY_ALT_V",			VK_V,				LOOKF_KEYSTROKE,		80,			VK_MENU},
	{NULL,					"KEY_ALT_W",			VK_W,				LOOKF_KEYSTROKE,		81,			VK_MENU},
	{NULL,					"KEY_ALT_X",			VK_X,				LOOKF_KEYSTROKE,		82,			VK_MENU},
	{NULL,					"KEY_ALT_Y",			VK_Y,				LOOKF_KEYSTROKE,		83,			VK_MENU},
	{NULL,					"KEY_ALT_Z",			VK_Z,				LOOKF_KEYSTROKE,		84,			VK_MENU},
	{NULL,					"KEY_ALT_SLASH",		VK_SLASH,			LOOKF_KEYSTROKE,		132,		VK_MENU},
	{NULL,					"KEY_ALT_TWO",			VK_TWO_FR,			LOOKF_KEYSTROKE,		139,		VK_MENU},
	{NULL,					"KEY_ALT_COMMA",		VK_COMMA_FR,		LOOKF_KEYSTROKE,		127,		VK_MENU},
	{NULL,					"KEY_ALT_ACCENTU",		VK_ACCENTU_FR,		LOOKF_KEYSTROKE,		133,		VK_MENU},
	{NULL,					"KEY_ALT_SEMICOLON",	VK_SEMICOLON_FR,	LOOKF_KEYSTROKE,		125,		VK_MENU},
	{NULL,					"KEY_ALT_COLON",		VK_COLON_FR,		LOOKF_KEYSTROKE,		134,		VK_MENU},
	{NULL,					"KEY_ALT_EXCLAMATION",	VK_EXCLAMATION_FR,	LOOKF_KEYSTROKE,		135,		VK_MENU},
	{NULL,					"KEY_ALT_CARROT",		VK_CARROT_FR,		LOOKF_KEYSTROKE,		136,		VK_MENU},
	{NULL,					"KEY_ALT_DOLLAR",		VK_DOLLAR_FR,		LOOKF_KEYSTROKE,		137,		VK_MENU},
	{NULL,					"KEY_ALT_RPARENTHES",	VK_RPARENTHES_FR,	LOOKF_KEYSTROKE,		138,		VK_MENU},
	{NULL,					"KEY_ALT_EQUAL",		VK_EQUAL_FR,		LOOKF_KEYSTROKE,		126,		VK_MENU},
	{NULL,					"KEY_ALT_LESSTHAN",		VK_LESSTHAN_FR,		LOOKF_KEYSTROKE,		145,		VK_MENU},
	{NULL,					"KEY_ALT_ASTERIK",		VK_ASTERIK_FR,		LOOKF_KEYSTROKE,		30,			VK_MENU},
//
// SHIFT keys mappings
//
	{NULL,					"KEY_SHIFT_BKSPC",		VK_BACK,			LOOKF_KEYSTROKE,		0,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_TAB",		VK_TAB,				LOOKF_KEYSTROKE,		1,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_RETURN",		VK_RETURN,			LOOKF_KEYSTROKE,		2,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_ENTER",		VK_RETURN,			LOOKF_KEYSTROKE,		2,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_SPACE",		VK_SPACE,			LOOKF_KEYSTROKE,		6,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_SPACEBAR",	VK_SPACE,			LOOKF_KEYSTROKE,		6,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_PGUP",		VK_PRIOR,			LOOKF_KEYSTROKE,		7,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_PAGEUP",		VK_PRIOR,			LOOKF_KEYSTROKE,		7,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_PGDN",		VK_NEXT,			LOOKF_KEYSTROKE,		8,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_PAGEDOWN",	VK_NEXT,			LOOKF_KEYSTROKE,		8,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_HOME",		VK_HOME,			LOOKF_KEYSTROKE,		9,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_END",		VK_END,				LOOKF_KEYSTROKE,		10,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_LEFT",		VK_LEFT,			LOOKF_KEYSTROKE,		11,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_UP",			VK_UP,				LOOKF_KEYSTROKE,		12,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_RIGHT",		VK_RIGHT,			LOOKF_KEYSTROKE,		13,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_DOWN",		VK_DOWN,			LOOKF_KEYSTROKE,		14,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_INS",		VK_INSERT,			LOOKF_KEYSTROKE,		15,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_INSERT",		VK_INSERT,			LOOKF_KEYSTROKE,		15,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_DEL",		VK_DELETE,			LOOKF_KEYSTROKE,		16,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_DELETE",		VK_DELETE,			LOOKF_KEYSTROKE,		16,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_APPS",		VK_APPS,			LOOKF_KEYSTROKE,		19,			VK_SHIFT},
	{"KEY_SHIFT_F01",		"KEY_SHIFT_F1",			VK_F1,				LOOKF_KEYSTROKE,		35,			VK_SHIFT},
	{"KEY_SHIFT_F02",		"KEY_SHIFT_F2",			VK_F2,				LOOKF_KEYSTROKE,		36,			VK_SHIFT},
	{"KEY_SHIFT_F03",		"KEY_SHIFT_F3",			VK_F3,				LOOKF_KEYSTROKE,		37,			VK_SHIFT},
	{"KEY_SHIFT_F04",		"KEY_SHIFT_F4",			VK_F4,				LOOKF_KEYSTROKE,		38,			VK_SHIFT},
	{"KEY_SHIFT_F05",		"KEY_SHIFT_F5",			VK_F5,				LOOKF_KEYSTROKE,		39,			VK_SHIFT},
	{"KEY_SHIFT_F06",		"KEY_SHIFT_F6",			VK_F6,				LOOKF_KEYSTROKE,		40,			VK_SHIFT},
	{"KEY_SHIFT_F07",		"KEY_SHIFT_F7",			VK_F7,				LOOKF_KEYSTROKE,		41,			VK_SHIFT},
	{"KEY_SHIFT_F08",		"KEY_SHIFT_F8",			VK_F8,				LOOKF_KEYSTROKE,		42,			VK_SHIFT},
	{"KEY_SHIFT_F09",		"KEY_SHIFT_F9",			VK_F9,				LOOKF_KEYSTROKE,		43,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_F10",		VK_F10,				LOOKF_KEYSTROKE,		44,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_F11",		VK_F11,				LOOKF_KEYSTROKE,		45,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_F12",		VK_F12,				LOOKF_KEYSTROKE,		46,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_NUMLOCK",	VK_NUMLOCK,			LOOKF_KEYSTROKE,		47,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_SCROLL",		VK_SCROLL,			LOOKF_KEYSTROKE,		48,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_0",			'0',				LOOKF_KEYSTROKE,		49,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_1",			'1',				LOOKF_KEYSTROKE,		50,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_2",			'2',				LOOKF_KEYSTROKE,		51,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_3",			'3',				LOOKF_KEYSTROKE,		52,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_4",			'4',				LOOKF_KEYSTROKE,		53,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_5",			'5',				LOOKF_KEYSTROKE,		54,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_6",			'6',				LOOKF_KEYSTROKE,		55,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_7",			'7',				LOOKF_KEYSTROKE,		56,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_8",			'8',				LOOKF_KEYSTROKE,		57,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_9",			'9',				LOOKF_KEYSTROKE,		58,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_A",			VK_A,				LOOKF_KEYSTROKE,		59,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_B",			VK_B,				LOOKF_KEYSTROKE,		60,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_C",			VK_C,				LOOKF_KEYSTROKE,		61,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_D",			VK_D,				LOOKF_KEYSTROKE,		62,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_E",			VK_E,				LOOKF_KEYSTROKE,		63,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_F",			VK_F,				LOOKF_KEYSTROKE,		64,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_G",			VK_G,				LOOKF_KEYSTROKE,		65,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_H",			VK_H,				LOOKF_KEYSTROKE,		66,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_I",			VK_I,				LOOKF_KEYSTROKE,		67,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_J",			VK_J,				LOOKF_KEYSTROKE,		68,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_K",			VK_K,				LOOKF_KEYSTROKE,		69,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_L",			VK_L,				LOOKF_KEYSTROKE,		70,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_M",			VK_M,				LOOKF_KEYSTROKE,		71,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_N",			VK_N,				LOOKF_KEYSTROKE,		72,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_O",			VK_O,				LOOKF_KEYSTROKE,		73,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_P",			VK_P,				LOOKF_KEYSTROKE,		74,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_Q",			VK_Q,				LOOKF_KEYSTROKE,		75,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_R",			VK_R,				LOOKF_KEYSTROKE,		76,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_S",			VK_S,				LOOKF_KEYSTROKE,		77,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_T",			VK_T,				LOOKF_KEYSTROKE,		78,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_U",			VK_U,				LOOKF_KEYSTROKE,		79,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_V",			VK_V,				LOOKF_KEYSTROKE,		80,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_W",			VK_W,				LOOKF_KEYSTROKE,		81,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_X",			VK_X,				LOOKF_KEYSTROKE,		82,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_Y",			VK_Y,				LOOKF_KEYSTROKE,		83,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_Z",			VK_Z,				LOOKF_KEYSTROKE,		84,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_TWO",		VK_TWO_FR,			LOOKF_KEYSTROKE,		139,		VK_SHIFT},
	{NULL,					"KEY_SHIFT_COMMA",		VK_COMMA_FR,		LOOKF_KEYSTROKE,		127,		VK_SHIFT},
	{NULL,					"KEY_SHIFT_ACCENTU",	VK_ACCENTU_FR,		LOOKF_KEYSTROKE,		133,		VK_SHIFT},
	{NULL,					"KEY_SHIFT_SEMICOLON",	VK_SEMICOLON_FR,	LOOKF_KEYSTROKE,		125,		VK_SHIFT},
	{NULL,					"KEY_SHIFT_COLON",		VK_COLON_FR,		LOOKF_KEYSTROKE,		134,		VK_SHIFT},
	{NULL,					"KEY_SHIFT_EXCLAMATION",VK_EXCLAMATION_FR,	LOOKF_KEYSTROKE,		135,		VK_SHIFT},
	{NULL,					"KEY_SHIFT_CARROT",		VK_CARROT_FR,		LOOKF_KEYSTROKE,		136,		VK_SHIFT},
	{NULL,					"KEY_SHIFT_DOLLAR",		VK_DOLLAR_FR,		LOOKF_KEYSTROKE,		137,		VK_SHIFT},
	{NULL,					"KEY_SHIFT_RPARENTHES",	VK_RPARENTHES_FR,	LOOKF_KEYSTROKE,		138,		VK_SHIFT},
	{NULL,					"KEY_SHIFT_EQUAL",		VK_EQUAL_FR,		LOOKF_KEYSTROKE,		126,		VK_SHIFT},
	{NULL,					"KEY_SHIFT_LESSTHAN",	VK_LESSTHAN_FR,		LOOKF_KEYSTROKE,		145,		VK_SHIFT},
	{NULL,					"KEY_SHIFT_ASTERIK",	VK_ASTERIK_FR,		LOOKF_KEYSTROKE,		30,			VK_SHIFT},
	{NULL,NULL,0,0,0}
};

VKLOOKUP vkLookup_ger[] = {
//
// Regular keys mappings
//
	{NULL,					"KEY_BACKSPACE",		VK_BACK,			LOOKF_KEYSTROKE,		0,			0},
	{NULL,					"KEY_TAB",				VK_TAB,				LOOKF_KEYSTROKE,		1,			0},
	{NULL,					"KEY_RETURN",			VK_RETURN,			LOOKF_KEYSTROKE,		2,			0},
	{NULL,					"KEY_ENTER",			VK_RETURN,			LOOKF_KEYSTROKE,		2,			0},
	{NULL,					"KEY_CAPS",				VK_CAPITAL,			LOOKF_KEYSTROKE,		5,			0},
	{NULL,					"KEY_SPACE",			VK_SPACE,			LOOKF_KEYSTROKE,		6,			0},
	{NULL,					"KEY_SPACEBAR",			VK_SPACE,			LOOKF_KEYSTROKE,		6,			0},
	{NULL,					"KEY_PGUP",				VK_PRIOR,			LOOKF_KEYSTROKE,		7,			0},
	{NULL,					"KEY_PAGEUP",			VK_PRIOR,			LOOKF_KEYSTROKE,		7,			0},
	{NULL,					"KEY_PGDN",				VK_NEXT,			LOOKF_KEYSTROKE,		8,			0},
	{NULL,					"KEY_PAGEDOWN",			VK_NEXT,			LOOKF_KEYSTROKE,		8,			0},
	{NULL,					"KEY_HOME",				VK_HOME,			LOOKF_KEYSTROKE,		9,			0},
	{NULL,					"KEY_END",				VK_END,				LOOKF_KEYSTROKE,		10,			0},
	{NULL,					"KEY_LEFT",				VK_LEFT,			LOOKF_KEYSTROKE,		11,			0},
	{NULL,					"KEY_UP",				VK_UP,				LOOKF_KEYSTROKE,		12,			0},
	{NULL,					"KEY_RIGHT",			VK_RIGHT,			LOOKF_KEYSTROKE,		13,			0},
	{NULL,					"KEY_DOWN",				VK_DOWN,			LOOKF_KEYSTROKE,		14,			0},
	{NULL,					"KEY_INS",				VK_INSERT,			LOOKF_KEYSTROKE,		15,			0},
	{NULL,					"KEY_INSERT",			VK_INSERT,			LOOKF_KEYSTROKE,		15,			0},
	{NULL,					"KEY_DEL",				VK_DELETE,			LOOKF_KEYSTROKE,		16,			0},
	{NULL,					"KEY_DELETE",			VK_DELETE,			LOOKF_KEYSTROKE,		16,			0},
	{NULL,					"KEY_APPS",				VK_APPS,			LOOKF_KEYSTROKE,		19,			0},
	{NULL,					"KEY_NUMPAD0",			VK_NUMPAD0,			LOOKF_KEYSTROKE,		20,			0},
	{NULL,					"KEY_NUMPAD1",			VK_NUMPAD1,			LOOKF_KEYSTROKE,		21,			0},
	{NULL,					"KEY_NUMPAD2",			VK_NUMPAD2,			LOOKF_KEYSTROKE,		22,			0},
	{NULL,					"KEY_NUMPAD3",			VK_NUMPAD3,			LOOKF_KEYSTROKE,		23,			0},
	{NULL,					"KEY_NUMPAD4",			VK_NUMPAD4,			LOOKF_KEYSTROKE,		24,			0},
	{NULL,					"KEY_NUMPAD5",			VK_NUMPAD5,			LOOKF_KEYSTROKE,		25,			0},
	{NULL,					"KEY_NUMPAD6",			VK_NUMPAD6,			LOOKF_KEYSTROKE,		26,			0},
	{NULL,					"KEY_NUMPAD7",			VK_NUMPAD7,			LOOKF_KEYSTROKE,		27,			0},
	{NULL,					"KEY_NUMPAD8",			VK_NUMPAD8,			LOOKF_KEYSTROKE,		28,			0},
	{NULL,					"KEY_NUMPAD9",			VK_NUMPAD9,			LOOKF_KEYSTROKE,		29,			0},
	{NULL,					"KEY_MULTIPLY",			VK_MULTIPLY,		LOOKF_KEYSTROKE,		30,			0},
	{NULL,					"KEY_ADD",				VK_ADD,				LOOKF_KEYSTROKE,		31,			0},
	{NULL,					"KEY_SUBTRACT",			VK_SUBTRACT,		LOOKF_KEYSTROKE,		32,			0},
	{NULL,					"KEY_SUB",				VK_SUBTRACT,		LOOKF_KEYSTROKE,		32,			0},
	{NULL,					"KEY_DECIMAL",			VK_DECIMAL,			LOOKF_KEYSTROKE,		33,			0},
	{NULL,					"KEY_DIVIDE",			VK_DIVIDE,			LOOKF_KEYSTROKE,		34,			0},
	{"KEY_F01",				"KEY_F1",				VK_F1,				LOOKF_KEYSTROKE,		35,			0},
	{"KEY_F02",				"KEY_F2",				VK_F2,				LOOKF_KEYSTROKE,		36,			0},
	{"KEY_F03",				"KEY_F3",				VK_F3,				LOOKF_KEYSTROKE,		37,			0},
	{"KEY_F04",				"KEY_F4",				VK_F4,				LOOKF_KEYSTROKE,		38,			0},
	{"KEY_F05",				"KEY_F5",				VK_F5,				LOOKF_KEYSTROKE,		39,			0},
	{"KEY_F06",				"KEY_F6",				VK_F6,				LOOKF_KEYSTROKE,		40,			0},
	{"KEY_F07",				"KEY_F7",				VK_F7,				LOOKF_KEYSTROKE,		41,			0},
	{"KEY_F08",				"KEY_F8",				VK_F8,				LOOKF_KEYSTROKE,		42,			0},
	{"KEY_F09",				"KEY_F9",				VK_F9,				LOOKF_KEYSTROKE,		43,			0},
	{NULL,					"KEY_F10",				VK_F10,				LOOKF_KEYSTROKE,		44,			0},
	{NULL,					"KEY_F11",				VK_F11,				LOOKF_KEYSTROKE,		45,			0},
	{NULL,					"KEY_F12",				VK_F12,				LOOKF_KEYSTROKE,		46,			0},
	{NULL,					"KEY_NUMLOCK",			VK_NUMLOCK,			LOOKF_KEYSTROKE,		47,			0},
	{NULL,					"KEY_SCROLL",			VK_SCROLL,			LOOKF_KEYSTROKE,		48,			0},
	{NULL,					"KEY_0",				'0',				LOOKF_KEYSTROKE,		49,			0},
	{NULL,					"KEY_1",				'1',				LOOKF_KEYSTROKE,		50,			0},
	{NULL,					"KEY_2",				'2',				LOOKF_KEYSTROKE,		51,			0},
	{NULL,					"KEY_3",				'3',				LOOKF_KEYSTROKE,		52,			0},
	{NULL,					"KEY_4",				'4',				LOOKF_KEYSTROKE,		53,			0},
	{NULL,					"KEY_5",				'5',				LOOKF_KEYSTROKE,		54,			0},
	{NULL,					"KEY_6",				'6',				LOOKF_KEYSTROKE,		55,			0},
	{NULL,					"KEY_7",				'7',				LOOKF_KEYSTROKE,		56,			0},
	{NULL,					"KEY_8",				'8',				LOOKF_KEYSTROKE,		57,			0},
	{NULL,					"KEY_9",				'9',				LOOKF_KEYSTROKE,		58,			0},
	{NULL,					"KEY_A",				VK_A_GR,			LOOKF_KEYSTROKE,		59,			0},
	{NULL,					"KEY_B",				VK_B_GR,			LOOKF_KEYSTROKE,		60,			0},
	{NULL,					"KEY_C",				VK_C_GR,			LOOKF_KEYSTROKE,		61,			0},
	{NULL,					"KEY_D",				VK_D_GR,			LOOKF_KEYSTROKE,		62,			0},
	{NULL,					"KEY_E",				VK_E_GR,			LOOKF_KEYSTROKE,		63,			0},
	{NULL,					"KEY_F",				VK_F_GR,			LOOKF_KEYSTROKE,		64,			0},
	{NULL,					"KEY_G",				VK_G_GR,			LOOKF_KEYSTROKE,		65,			0},
	{NULL,					"KEY_H",				VK_H_GR,			LOOKF_KEYSTROKE,		66,			0},
	{NULL,					"KEY_I",				VK_I_GR,			LOOKF_KEYSTROKE,		67,			0},
	{NULL,					"KEY_J",				VK_J_GR,			LOOKF_KEYSTROKE,		68,			0},
	{NULL,					"KEY_K",				VK_K_GR,			LOOKF_KEYSTROKE,		69,			0},
	{NULL,					"KEY_L",				VK_L_GR,			LOOKF_KEYSTROKE,		70,			0},
	{NULL,					"KEY_M",				VK_M_GR,			LOOKF_KEYSTROKE,		71,			0},
	{NULL,					"KEY_N",				VK_N_GR,			LOOKF_KEYSTROKE,		72,			0},
	{NULL,					"KEY_O",				VK_O_GR,			LOOKF_KEYSTROKE,		73,			0},
	{NULL,					"KEY_P",				VK_P_GR,			LOOKF_KEYSTROKE,		74,			0},
	{NULL,					"KEY_Q",				VK_Q_GR,			LOOKF_KEYSTROKE,		75,			0},
	{NULL,					"KEY_R",				VK_R_GR,			LOOKF_KEYSTROKE,		76,			0},
	{NULL,					"KEY_S",				VK_S_GR,			LOOKF_KEYSTROKE,		77,			0},
	{NULL,					"KEY_T",				VK_T_GR,			LOOKF_KEYSTROKE,		78,			0},
	{NULL,					"KEY_U",				VK_U_GR,			LOOKF_KEYSTROKE,		79,			0},
	{NULL,					"KEY_V",				VK_V_GR,			LOOKF_KEYSTROKE,		80,			0},
	{NULL,					"KEY_W",				VK_W_GR,			LOOKF_KEYSTROKE,		81,			0},
	{NULL,					"KEY_X",				VK_X_GR,			LOOKF_KEYSTROKE,		82,			0},
	{NULL,					"KEY_Y",				VK_Y_GR,			LOOKF_KEYSTROKE,		83,			0},
	{NULL,					"KEY_Z",				VK_Z_GR,			LOOKF_KEYSTROKE,		84,			0},
	{"JOY1_BUTTON01",		"JOY1_BUTTON1",			JOY_BUTTON1,		LOOKF_JOY1,				85,			0},
	{"JOY1_BUTTON02",		"JOY1_BUTTON2",			JOY_BUTTON2,		LOOKF_JOY1,				86,			0},
	{"JOY1_BUTTON03",		"JOY1_BUTTON3",			JOY_BUTTON3,		LOOKF_JOY1,				87,			0},
	{"JOY1_BUTTON04",		"JOY1_BUTTON4",			JOY_BUTTON4,		LOOKF_JOY1,				88,			0},
	{"JOY1_BUTTON05",		"JOY1_BUTTON5",			JOY_BUTTON5,		LOOKF_JOY1,				89,			0},
	{"JOY1_BUTTON06",		"JOY1_BUTTON6",			JOY_BUTTON6,		LOOKF_JOY1,				90,			0},
	{"JOY1_BUTTON07",		"JOY1_BUTTON7",			JOY_BUTTON7,		LOOKF_JOY1,				91,			0},
	{"JOY1_BUTTON08",		"JOY1_BUTTON8",			JOY_BUTTON8,		LOOKF_JOY1,				92,			0},
	{"JOY1_BUTTON09",		"JOY1_BUTTON9",			JOY_BUTTON9,		LOOKF_JOY1,				93,			0},
	{NULL,					"JOY1_BUTTON10",		JOY_BUTTON10,		LOOKF_JOY1,				94,			0},
	{NULL,					"JOY1_BUTTON11",		JOY_BUTTON11,		LOOKF_JOY1,				95,			0},
	{NULL,					"JOY1_BUTTON12",		JOY_BUTTON12,		LOOKF_JOY1,				96,			0},
	{NULL,					"JOY1_BUTTON13",		JOY_BUTTON13,		LOOKF_JOY1,				97,			0},
	{NULL,					"JOY1_BUTTON14",		JOY_BUTTON14,		LOOKF_JOY1,				98,			0},
	{NULL,					"JOY1_BUTTON15",		JOY_BUTTON15,		LOOKF_JOY1,				99,			0},
	{NULL,					"JOY1_BUTTON16",		JOY_BUTTON16,		LOOKF_JOY1,				100,		0},
	{"JOY2_BUTTON01",		"JOY2_BUTTON1",			JOY_BUTTON1,		LOOKF_JOY2,				101,		0},
	{"JOY2_BUTTON02",		"JOY2_BUTTON2",			JOY_BUTTON2,		LOOKF_JOY2,				102,		0},
	{"JOY2_BUTTON03",		"JOY2_BUTTON3",			JOY_BUTTON3,		LOOKF_JOY2,				103,		0},
	{"JOY2_BUTTON04",		"JOY2_BUTTON4",			JOY_BUTTON4,		LOOKF_JOY2,				104,		0},
	{"JOY2_BUTTON05",		"JOY2_BUTTON5",			JOY_BUTTON5,		LOOKF_JOY2,				105,		0},
	{"JOY2_BUTTON06",		"JOY2_BUTTON6",			JOY_BUTTON6,		LOOKF_JOY2,				106,		0},
	{"JOY2_BUTTON07",		"JOY2_BUTTON7",			JOY_BUTTON7,		LOOKF_JOY2,				107,		0},
	{"JOY2_BUTTON08",		"JOY2_BUTTON8",			JOY_BUTTON8,		LOOKF_JOY2,				108,		0},
	{"JOY2_BUTTON09",		"JOY2_BUTTON9",			JOY_BUTTON9,		LOOKF_JOY2,				109,		0},
	{NULL,					"JOY2_BUTTON10",		JOY_BUTTON10,		LOOKF_JOY2,				110,		0},
	{NULL,					"JOY2_BUTTON11",		JOY_BUTTON11,		LOOKF_JOY2,				111,		0},
	{NULL,					"JOY2_BUTTON12",		JOY_BUTTON12,		LOOKF_JOY2,				112,		0},
	{NULL,					"JOY2_BUTTON13",		JOY_BUTTON13,		LOOKF_JOY2,				113,		0},
	{NULL,					"JOY2_BUTTON14",		JOY_BUTTON14,		LOOKF_JOY2,				114,		0},
	{NULL,					"JOY2_BUTTON15",		JOY_BUTTON15,		LOOKF_JOY2,				115,		0},
	{NULL,					"JOY2_BUTTON16",		JOY_BUTTON16,		LOOKF_JOY2,				116,		0},
	{NULL,					"JOY1_HATUP",			JOY_POVFORWARD,		LOOKF_JOYHAT1,			117,		0},
	{NULL,					"JOY1_HATRIGHT",		JOY_POVRIGHT,		LOOKF_JOYHAT1,			118,		0},
	{NULL,					"JOY1_HATDOWN",			JOY_POVBACKWARD,	LOOKF_JOYHAT1,			119,		0},
	{NULL,					"JOY1_HATLEFT",			JOY_POVLEFT,		LOOKF_JOYHAT1,			120,		0},
	{NULL,					"JOY2_HATUP",			JOY_POVFORWARD,		LOOKF_JOYHAT2,			121,		0},
	{NULL,					"JOY2_HATRIGHT",		JOY_POVRIGHT,		LOOKF_JOYHAT2,			122,		0},
	{NULL,					"JOY2_HATDOWN",			JOY_POVBACKWARD,	LOOKF_JOYHAT2,			123,		0},
	{NULL,					"JOY2_HATLEFT",			JOY_POVLEFT,		LOOKF_JOYHAT2,			124,		0},
	{NULL,					"KEY_MINUS",			VK_MINUS_GR,		LOOKF_KEYSTROKE,		32,			0},
	{NULL,					"KEY_OMLATO",			VK_OMLATO_GR,		LOOKF_KEYSTROKE,		141,		0},
	{NULL,					"KEY_OMLATA",			VK_OMLATA_GR,		LOOKF_KEYSTROKE,		143,		0},
	{NULL,					"KEY_OMLATU",			VK_OMLATU_GR,		LOOKF_KEYSTROKE,		142,		0},
	{NULL,					"KEY_PLUS",				VK_PLUS_GR,			LOOKF_KEYSTROKE,		31,			0},
	{NULL,					"KEY_BETA",				VK_BETA_GR,			LOOKF_KEYSTROKE,		144,		0},
	{NULL,					"KEY_ACCENT",			VK_ACCENT_GR,		LOOKF_KEYSTROKE,		128,		0},
	{NULL,					"KEY_PERIOD",			VK_PERIOD_GR,		LOOKF_KEYSTROKE,		33,			0},
	{NULL,					"KEY_COMMA",			VK_COMMA_GR,		LOOKF_KEYSTROKE,		127,		0},
	{NULL,					"KEY_POUND",			VK_POUND_GR,		LOOKF_KEYSTROKE,		140,		0},
	{NULL,					"KEY_LESSTHAN",			VK_LESSTHAN_GR,		LOOKF_KEYSTROKE,		145,		0},
	{NULL,					"KEY_SEMICOLON",		VK_SEMICOLON_GR,	LOOKF_KEYSTROKE,		125,		0},
	{NULL,					"KEY_CARROT",			VK_CARROT_GR,		LOOKF_KEYSTROKE,		136,		0},

//
// CTRL keys mappings
//
	{NULL,					"KEY_CTRL_BKSPC",		VK_BACK,			LOOKF_KEYSTROKE,		0,			VK_CONTROL},
	{NULL,					"KEY_CTRL_TAB",			VK_TAB,				LOOKF_KEYSTROKE,		1,			VK_CONTROL},
	{NULL,					"KEY_CTRL_RETURN",		VK_RETURN,			LOOKF_KEYSTROKE,		2,			VK_CONTROL},
	{NULL,					"KEY_CTRL_ENTER",		VK_RETURN,			LOOKF_KEYSTROKE,		2,			VK_CONTROL},
	{NULL,					"KEY_CTRL_SPACE",		VK_SPACE,			LOOKF_KEYSTROKE,		6,			VK_CONTROL},
	{NULL,					"KEY_CTRL_SPACEBAR",	VK_SPACE,			LOOKF_KEYSTROKE,		6,			VK_CONTROL},
	{NULL,					"KEY_CTRL_PGUP",		VK_PRIOR,			LOOKF_KEYSTROKE,		7,			VK_CONTROL},
	{NULL,					"KEY_CTRL_PAGEUP",		VK_PRIOR,			LOOKF_KEYSTROKE,		7,			VK_CONTROL},
	{NULL,					"KEY_CTRL_PGDN",		VK_NEXT,			LOOKF_KEYSTROKE,		8,			VK_CONTROL},
	{NULL,					"KEY_CTRL_PAGEDOWN",	VK_NEXT,			LOOKF_KEYSTROKE,		8,			VK_CONTROL},
	{NULL,					"KEY_CTRL_HOME",		VK_HOME,			LOOKF_KEYSTROKE,		9,			VK_CONTROL},
	{NULL,					"KEY_CTRL_END",			VK_END,				LOOKF_KEYSTROKE,		10,			VK_CONTROL},
	{NULL,					"KEY_CTRL_LEFT",		VK_LEFT,			LOOKF_KEYSTROKE,		11,			VK_CONTROL},
	{NULL,					"KEY_CTRL_UP",			VK_UP,				LOOKF_KEYSTROKE,		12,			VK_CONTROL},
	{NULL,					"KEY_CTRL_RIGHT",		VK_RIGHT,			LOOKF_KEYSTROKE,		13,			VK_CONTROL},
	{NULL,					"KEY_CTRL_DOWN",		VK_DOWN,			LOOKF_KEYSTROKE,		14,			VK_CONTROL},
	{NULL,					"KEY_CTRL_INS",			VK_INSERT,			LOOKF_KEYSTROKE,		15,			VK_CONTROL},
	{NULL,					"KEY_CTRL_INSERT",		VK_INSERT,			LOOKF_KEYSTROKE,		15,			VK_CONTROL},
	{NULL,					"KEY_CTRL_DEL",			VK_DELETE,			LOOKF_KEYSTROKE,		16,			VK_CONTROL},
	{NULL,					"KEY_CTRL_DELETE",		VK_DELETE,			LOOKF_KEYSTROKE,		16,			VK_CONTROL},
	{NULL,					"KEY_CTRL_APPS",		VK_APPS,			LOOKF_KEYSTROKE,		19,			VK_CONTROL},
	{"KEY_CTRL_F01",		"KEY_CTRL_F1",			VK_F1,				LOOKF_KEYSTROKE,		35,			VK_CONTROL},
	{"KEY_CTRL_F02",		"KEY_CTRL_F2",			VK_F2,				LOOKF_KEYSTROKE,		36,			VK_CONTROL},
	{"KEY_CTRL_F03",		"KEY_CTRL_F3",			VK_F3,				LOOKF_KEYSTROKE,		37,			VK_CONTROL},
	{"KEY_CTRL_F04",		"KEY_CTRL_F4",			VK_F4,				LOOKF_KEYSTROKE,		38,			VK_CONTROL},
	{"KEY_CTRL_F05",		"KEY_CTRL_F5",			VK_F5,				LOOKF_KEYSTROKE,		39,			VK_CONTROL},
	{"KEY_CTRL_F06",		"KEY_CTRL_F6",			VK_F6,				LOOKF_KEYSTROKE,		40,			VK_CONTROL},
	{"KEY_CTRL_F07",		"KEY_CTRL_F7",			VK_F7,				LOOKF_KEYSTROKE,		41,			VK_CONTROL},
	{"KEY_CTRL_F08",		"KEY_CTRL_F8",			VK_F8,				LOOKF_KEYSTROKE,		42,			VK_CONTROL},
	{"KEY_CTRL_F09",		"KEY_CTRL_F9",			VK_F9,				LOOKF_KEYSTROKE,		43,			VK_CONTROL},
	{NULL,					"KEY_CTRL_F10",			VK_F10,				LOOKF_KEYSTROKE,		44,			VK_CONTROL},
	{NULL,					"KEY_CTRL_F11",			VK_F11,				LOOKF_KEYSTROKE,		45,			VK_CONTROL},
	{NULL,					"KEY_CTRL_F12",			VK_F12,				LOOKF_KEYSTROKE,		46,			VK_CONTROL},
	{NULL,					"KEY_CTRL_NUMLOCK",		VK_NUMLOCK,			LOOKF_KEYSTROKE,		47,			VK_CONTROL},
	{NULL,					"KEY_CTRL_SCROLL",		VK_SCROLL,			LOOKF_KEYSTROKE,		48,			VK_CONTROL},
	{NULL,					"KEY_CTRL_0",			'0',				LOOKF_KEYSTROKE,		49,			VK_CONTROL},
	{NULL,					"KEY_CTRL_1",			'1',				LOOKF_KEYSTROKE,		50,			VK_CONTROL},
	{NULL,					"KEY_CTRL_2",			'2',				LOOKF_KEYSTROKE,		51,			VK_CONTROL},
	{NULL,					"KEY_CTRL_3",			'3',				LOOKF_KEYSTROKE,		52,			VK_CONTROL},
	{NULL,					"KEY_CTRL_4",			'4',				LOOKF_KEYSTROKE,		53,			VK_CONTROL},
	{NULL,					"KEY_CTRL_5",			'5',				LOOKF_KEYSTROKE,		54,			VK_CONTROL},
	{NULL,					"KEY_CTRL_6",			'6',				LOOKF_KEYSTROKE,		55,			VK_CONTROL},
	{NULL,					"KEY_CTRL_7",			'7',				LOOKF_KEYSTROKE,		56,			VK_CONTROL},
	{NULL,					"KEY_CTRL_8",			'8',				LOOKF_KEYSTROKE,		57,			VK_CONTROL},
	{NULL,					"KEY_CTRL_9",			'9',				LOOKF_KEYSTROKE,		58,			VK_CONTROL},
	{NULL,					"KEY_CTRL_A",			VK_A_GR,			LOOKF_KEYSTROKE,		59,			VK_CONTROL},
	{NULL,					"KEY_CTRL_B",			VK_B_GR,			LOOKF_KEYSTROKE,		60,			VK_CONTROL},
	{NULL,					"KEY_CTRL_C",			VK_C_GR,			LOOKF_KEYSTROKE,		61,			VK_CONTROL},
	{NULL,					"KEY_CTRL_D",			VK_D_GR,			LOOKF_KEYSTROKE,		62,			VK_CONTROL},
	{NULL,					"KEY_CTRL_E",			VK_E_GR,			LOOKF_KEYSTROKE,		63,			VK_CONTROL},
	{NULL,					"KEY_CTRL_F",			VK_F_GR,			LOOKF_KEYSTROKE,		64,			VK_CONTROL},
	{NULL,					"KEY_CTRL_G",			VK_G_GR,			LOOKF_KEYSTROKE,		65,			VK_CONTROL},
	{NULL,					"KEY_CTRL_H",			VK_H_GR,			LOOKF_KEYSTROKE,		66,			VK_CONTROL},
	{NULL,					"KEY_CTRL_I",			VK_I_GR,			LOOKF_KEYSTROKE,		67,			VK_CONTROL},
	{NULL,					"KEY_CTRL_J",			VK_J_GR,			LOOKF_KEYSTROKE,		68,			VK_CONTROL},
	{NULL,					"KEY_CTRL_K",			VK_K_GR,			LOOKF_KEYSTROKE,		69,			VK_CONTROL},
	{NULL,					"KEY_CTRL_L",			VK_L_GR,			LOOKF_KEYSTROKE,		70,			VK_CONTROL},
	{NULL,					"KEY_CTRL_M",			VK_M_GR,			LOOKF_KEYSTROKE,		71,			VK_CONTROL},
	{NULL,					"KEY_CTRL_N",			VK_N_GR,			LOOKF_KEYSTROKE,		72,			VK_CONTROL},
	{NULL,					"KEY_CTRL_O",			VK_O_GR,			LOOKF_KEYSTROKE,		73,			VK_CONTROL},
	{NULL,					"KEY_CTRL_P",			VK_P_GR,			LOOKF_KEYSTROKE,		74,			VK_CONTROL},
	{NULL,					"KEY_CTRL_Q",			VK_Q_GR,			LOOKF_KEYSTROKE,		75,			VK_CONTROL},
	{NULL,					"KEY_CTRL_R",			VK_R_GR,			LOOKF_KEYSTROKE,		76,			VK_CONTROL},
	{NULL,					"KEY_CTRL_S",			VK_S_GR,			LOOKF_KEYSTROKE,		77,			VK_CONTROL},
	{NULL,					"KEY_CTRL_T",			VK_T_GR,			LOOKF_KEYSTROKE,		78,			VK_CONTROL},
	{NULL,					"KEY_CTRL_U",			VK_U_GR,			LOOKF_KEYSTROKE,		79,			VK_CONTROL},
	{NULL,					"KEY_CTRL_V",			VK_V_GR,			LOOKF_KEYSTROKE,		80,			VK_CONTROL},
	{NULL,					"KEY_CTRL_W",			VK_W_GR,			LOOKF_KEYSTROKE,		81,			VK_CONTROL},
	{NULL,					"KEY_CTRL_X",			VK_X_GR,			LOOKF_KEYSTROKE,		82,			VK_CONTROL},
	{NULL,					"KEY_CTRL_Y",			VK_Y_GR,			LOOKF_KEYSTROKE,		83,			VK_CONTROL},
	{NULL,					"KEY_CTRL_Z",			VK_Z_GR,			LOOKF_KEYSTROKE,		84,			VK_CONTROL},
	{NULL,					"KEY_CTRL_MINUS",		VK_MINUS_GR,		LOOKF_KEYSTROKE,		32,			VK_CONTROL},
	{NULL,					"KEY_CTRL_OMLATO",		VK_OMLATO_GR,		LOOKF_KEYSTROKE,		141,		VK_CONTROL},
	{NULL,					"KEY_CTRL_OMLATA",		VK_OMLATA_GR,		LOOKF_KEYSTROKE,		143,		VK_CONTROL},
	{NULL,					"KEY_CTRL_OMLATU",		VK_OMLATU_GR,		LOOKF_KEYSTROKE,		142,		VK_CONTROL},
	{NULL,					"KEY_CTRL_PLUS",		VK_PLUS_GR,			LOOKF_KEYSTROKE,		31,			VK_CONTROL},
	{NULL,					"KEY_CTRL_BETA",		VK_BETA_GR,			LOOKF_KEYSTROKE,		144,		VK_CONTROL},
	{NULL,					"KEY_CTRL_ACCENT",		VK_ACCENT_GR,		LOOKF_KEYSTROKE,		128,		VK_CONTROL},
	{NULL,					"KEY_CTRL_PERIOD",		VK_PERIOD_GR,		LOOKF_KEYSTROKE,		33,			VK_CONTROL},
	{NULL,					"KEY_CTRL_COMMA",		VK_COMMA_GR,		LOOKF_KEYSTROKE,		127,		VK_CONTROL},
	{NULL,					"KEY_CTRL_POUND",		VK_POUND_GR,		LOOKF_KEYSTROKE,		140,		VK_CONTROL},
	{NULL,					"KEY_CTRL_LESSTHAN",	VK_LESSTHAN_GR,		LOOKF_KEYSTROKE,		145,		VK_CONTROL},
	{NULL,					"KEY_CTRL_SEMICOLON",	VK_SEMICOLON_GR,	LOOKF_KEYSTROKE,		125,		VK_CONTROL},
	{NULL,					"KEY_CTRL_CARROT",		VK_CARROT_GR,		LOOKF_KEYSTROKE,		136,		VK_CONTROL},

//
// ALT keys mappings
//
	{NULL,					"KEY_ALT_BKSPC",		VK_BACK,			LOOKF_KEYSTROKE,		0,			VK_MENU},
	{NULL,					"KEY_ALT_TAB",			VK_TAB,				LOOKF_KEYSTROKE,		1,			VK_MENU},
	{NULL,					"KEY_ALT_RETURN",		VK_RETURN,			LOOKF_KEYSTROKE,		2,			VK_MENU},
	{NULL,					"KEY_ALT_ENTER",		VK_RETURN,			LOOKF_KEYSTROKE,		2,			VK_MENU},
	{NULL,					"KEY_ALT_SPACE",		VK_SPACE,			LOOKF_KEYSTROKE,		6,			VK_MENU},
	{NULL,					"KEY_ALT_SPACEBAR",		VK_SPACE,			LOOKF_KEYSTROKE,		6,			VK_MENU},
	{NULL,					"KEY_ALT_PGUP",			VK_PRIOR,			LOOKF_KEYSTROKE,		7,			VK_MENU},
	{NULL,					"KEY_ALT_PAGEUP",		VK_PRIOR,			LOOKF_KEYSTROKE,		7,			VK_MENU},
	{NULL,					"KEY_ALT_PGDN",			VK_NEXT,			LOOKF_KEYSTROKE,		8,			VK_MENU},
	{NULL,					"KEY_ALT_PAGEDOWN",		VK_NEXT,			LOOKF_KEYSTROKE,		8,			VK_MENU},
	{NULL,					"KEY_ALT_HOME",			VK_HOME,			LOOKF_KEYSTROKE,		9,			VK_MENU},
	{NULL,					"KEY_ALT_END",			VK_END,				LOOKF_KEYSTROKE,		10,			VK_MENU},
	{NULL,					"KEY_ALT_LEFT",			VK_LEFT,			LOOKF_KEYSTROKE,		11,			VK_MENU},
	{NULL,					"KEY_ALT_UP",			VK_UP,				LOOKF_KEYSTROKE,		12,			VK_MENU},
	{NULL,					"KEY_ALT_RIGHT",		VK_RIGHT,			LOOKF_KEYSTROKE,		13,			VK_MENU},
	{NULL,					"KEY_ALT_DOWN",			VK_DOWN,			LOOKF_KEYSTROKE,		14,			VK_MENU},
	{NULL,					"KEY_ALT_INS",			VK_INSERT,			LOOKF_KEYSTROKE,		15,			VK_MENU},
	{NULL,					"KEY_ALT_INSERT",		VK_INSERT,			LOOKF_KEYSTROKE,		15,			VK_MENU},
	{NULL,					"KEY_ALT_DEL",			VK_DELETE,			LOOKF_KEYSTROKE,		16,			VK_MENU},
	{NULL,					"KEY_ALT_DELETE",		VK_DELETE,			LOOKF_KEYSTROKE,		16,			VK_MENU},
	{NULL,					"KEY_ALT_APPS",			VK_APPS,			LOOKF_KEYSTROKE,		19,			VK_MENU},
	{"KEY_ALT_F01",			"KEY_ALT_F1",			VK_F1,				LOOKF_KEYSTROKE,		35,			VK_MENU},
	{"KEY_ALT_F02",			"KEY_ALT_F2",			VK_F2,				LOOKF_KEYSTROKE,		36,			VK_MENU},
	{"KEY_ALT_F03",			"KEY_ALT_F3",			VK_F3,				LOOKF_KEYSTROKE,		37,			VK_MENU},
	{"KEY_ALT_F04",			"KEY_ALT_F4",			VK_F4,				LOOKF_KEYSTROKE,		38,			VK_MENU},
	{"KEY_ALT_F05",			"KEY_ALT_F5",			VK_F5,				LOOKF_KEYSTROKE,		39,			VK_MENU},
	{"KEY_ALT_F06",			"KEY_ALT_F6",			VK_F6,				LOOKF_KEYSTROKE,		40,			VK_MENU},
	{"KEY_ALT_F07",			"KEY_ALT_F7",			VK_F7,				LOOKF_KEYSTROKE,		41,			VK_MENU},
	{"KEY_ALT_F08",			"KEY_ALT_F8",			VK_F8,				LOOKF_KEYSTROKE,		42,			VK_MENU},
	{"KEY_ALT_F09",			"KEY_ALT_F9",			VK_F9,				LOOKF_KEYSTROKE,		43,			VK_MENU},
	{NULL,					"KEY_ALT_F10",			VK_F10,				LOOKF_KEYSTROKE,		44,			VK_MENU},
	{NULL,					"KEY_ALT_F11",			VK_F11,				LOOKF_KEYSTROKE,		45,			VK_MENU},
	{NULL,					"KEY_ALT_F12",			VK_F12,				LOOKF_KEYSTROKE,		46,			VK_MENU},
	{NULL,					"KEY_ALT_NUMLOCK",		VK_NUMLOCK,			LOOKF_KEYSTROKE,		47,			VK_MENU},
	{NULL,					"KEY_ALT_SCROLL",		VK_SCROLL,			LOOKF_KEYSTROKE,		48,			VK_MENU},
	{NULL,					"KEY_ALT_0",			'0',				LOOKF_KEYSTROKE,		49,			VK_MENU},
	{NULL,					"KEY_ALT_1",			'1',				LOOKF_KEYSTROKE,		50,			VK_MENU},
	{NULL,					"KEY_ALT_2",			'2',				LOOKF_KEYSTROKE,		51,			VK_MENU},
	{NULL,					"KEY_ALT_3",			'3',				LOOKF_KEYSTROKE,		52,			VK_MENU},
	{NULL,					"KEY_ALT_4",			'4',				LOOKF_KEYSTROKE,		53,			VK_MENU},
	{NULL,					"KEY_ALT_5",			'5',				LOOKF_KEYSTROKE,		54,			VK_MENU},
	{NULL,					"KEY_ALT_6",			'6',				LOOKF_KEYSTROKE,		55,			VK_MENU},
	{NULL,					"KEY_ALT_7",			'7',				LOOKF_KEYSTROKE,		56,			VK_MENU},
	{NULL,					"KEY_ALT_8",			'8',				LOOKF_KEYSTROKE,		57,			VK_MENU},
	{NULL,					"KEY_ALT_9",			'9',				LOOKF_KEYSTROKE,		58,			VK_MENU},
	{NULL,					"KEY_ALT_A",			VK_A_GR,			LOOKF_KEYSTROKE,		59,			VK_MENU},
	{NULL,					"KEY_ALT_B",			VK_B_GR,			LOOKF_KEYSTROKE,		60,			VK_MENU},
	{NULL,					"KEY_ALT_C",			VK_C_GR,			LOOKF_KEYSTROKE,		61,			VK_MENU},
	{NULL,					"KEY_ALT_D",			VK_D_GR,			LOOKF_KEYSTROKE,		62,			VK_MENU},
	{NULL,					"KEY_ALT_E",			VK_E_GR,			LOOKF_KEYSTROKE,		63,			VK_MENU},
	{NULL,					"KEY_ALT_F",			VK_F_GR,			LOOKF_KEYSTROKE,		64,			VK_MENU},
	{NULL,					"KEY_ALT_G",			VK_G_GR,			LOOKF_KEYSTROKE,		65,			VK_MENU},
	{NULL,					"KEY_ALT_H",			VK_H_GR,			LOOKF_KEYSTROKE,		66,			VK_MENU},
	{NULL,					"KEY_ALT_I",			VK_I_GR,			LOOKF_KEYSTROKE,		67,			VK_MENU},
	{NULL,					"KEY_ALT_J",			VK_J_GR,			LOOKF_KEYSTROKE,		68,			VK_MENU},
	{NULL,					"KEY_ALT_K",			VK_K_GR,			LOOKF_KEYSTROKE,		69,			VK_MENU},
	{NULL,					"KEY_ALT_L",			VK_L_GR,			LOOKF_KEYSTROKE,		70,			VK_MENU},
	{NULL,					"KEY_ALT_M",			VK_M_GR,			LOOKF_KEYSTROKE,		71,			VK_MENU},
	{NULL,					"KEY_ALT_N",			VK_N_GR,			LOOKF_KEYSTROKE,		72,			VK_MENU},
	{NULL,					"KEY_ALT_O",			VK_O_GR,			LOOKF_KEYSTROKE,		73,			VK_MENU},
	{NULL,					"KEY_ALT_P",			VK_P_GR,			LOOKF_KEYSTROKE,		74,			VK_MENU},
	{NULL,					"KEY_ALT_Q",			VK_Q_GR,			LOOKF_KEYSTROKE,		75,			VK_MENU},
	{NULL,					"KEY_ALT_R",			VK_R_GR,			LOOKF_KEYSTROKE,		76,			VK_MENU},
	{NULL,					"KEY_ALT_S",			VK_S_GR,			LOOKF_KEYSTROKE,		77,			VK_MENU},
	{NULL,					"KEY_ALT_T",			VK_T_GR,			LOOKF_KEYSTROKE,		78,			VK_MENU},
	{NULL,					"KEY_ALT_U",			VK_U_GR,			LOOKF_KEYSTROKE,		79,			VK_MENU},
	{NULL,					"KEY_ALT_V",			VK_V_GR,			LOOKF_KEYSTROKE,		80,			VK_MENU},
	{NULL,					"KEY_ALT_W",			VK_W_GR,			LOOKF_KEYSTROKE,		81,			VK_MENU},
	{NULL,					"KEY_ALT_X",			VK_X_GR,			LOOKF_KEYSTROKE,		82,			VK_MENU},
	{NULL,					"KEY_ALT_Y",			VK_Y_GR,			LOOKF_KEYSTROKE,		83,			VK_MENU},
	{NULL,					"KEY_ALT_Z",			VK_Z_GR,			LOOKF_KEYSTROKE,		84,			VK_MENU},
	{NULL,					"KEY_ALT_MINUS",		VK_MINUS_GR,		LOOKF_KEYSTROKE,		32,			VK_MENU},
	{NULL,					"KEY_ALT_OMLATO",		VK_OMLATO_GR,		LOOKF_KEYSTROKE,		141,		VK_MENU},
	{NULL,					"KEY_ALT_OMLATA",		VK_OMLATA_GR,		LOOKF_KEYSTROKE,		143,		VK_MENU},
	{NULL,					"KEY_ALT_OMLATU",		VK_OMLATU_GR,		LOOKF_KEYSTROKE,		142,		VK_MENU},
	{NULL,					"KEY_ALT_PLUS",			VK_PLUS_GR,			LOOKF_KEYSTROKE,		31,			VK_MENU},
	{NULL,					"KEY_ALT_BETA",			VK_BETA_GR,			LOOKF_KEYSTROKE,		144,		VK_MENU},
	{NULL,					"KEY_ALT_ACCENT",		VK_ACCENT_GR,		LOOKF_KEYSTROKE,		128,		VK_MENU},
	{NULL,					"KEY_ALT_PERIOD",		VK_PERIOD_GR,		LOOKF_KEYSTROKE,		33,			VK_MENU},
	{NULL,					"KEY_ALT_COMMA",		VK_COMMA_GR,		LOOKF_KEYSTROKE,		127,		VK_MENU},
	{NULL,					"KEY_ALT_POUND",		VK_POUND_GR,		LOOKF_KEYSTROKE,		140,		VK_MENU},
	{NULL,					"KEY_ALT_LESSTHAN",		VK_LESSTHAN_GR,		LOOKF_KEYSTROKE,		145,		VK_MENU},
	{NULL,					"KEY_ALT_SEMICOLON",	VK_SEMICOLON_GR,	LOOKF_KEYSTROKE,		125,		VK_MENU},
	{NULL,					"KEY_ALT_CARROT",		VK_CARROT_GR,		LOOKF_KEYSTROKE,		136,		VK_MENU},

//
// SHIFT keys mappings
//
	{NULL,					"KEY_SHIFT_BKSPC",		VK_BACK,			LOOKF_KEYSTROKE,		0,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_TAB",		VK_TAB,				LOOKF_KEYSTROKE,		1,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_RETURN",		VK_RETURN,			LOOKF_KEYSTROKE,		2,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_ENTER",		VK_RETURN,			LOOKF_KEYSTROKE,		2,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_SPACE",		VK_SPACE,			LOOKF_KEYSTROKE,		6,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_SPACEBAR",	VK_SPACE,			LOOKF_KEYSTROKE,		6,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_PGUP",		VK_PRIOR,			LOOKF_KEYSTROKE,		7,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_PAGEUP",		VK_PRIOR,			LOOKF_KEYSTROKE,		7,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_PGDN",		VK_NEXT,			LOOKF_KEYSTROKE,		8,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_PAGEDOWN",	VK_NEXT,			LOOKF_KEYSTROKE,		8,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_HOME",		VK_HOME,			LOOKF_KEYSTROKE,		9,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_END",		VK_END,				LOOKF_KEYSTROKE,		10,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_LEFT",		VK_LEFT,			LOOKF_KEYSTROKE,		11,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_UP",			VK_UP,				LOOKF_KEYSTROKE,		12,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_RIGHT",		VK_RIGHT,			LOOKF_KEYSTROKE,		13,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_DOWN",		VK_DOWN,			LOOKF_KEYSTROKE,		14,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_INS",		VK_INSERT,			LOOKF_KEYSTROKE,		15,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_INSERT",		VK_INSERT,			LOOKF_KEYSTROKE,		15,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_DEL",		VK_DELETE,			LOOKF_KEYSTROKE,		16,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_DELETE",		VK_DELETE,			LOOKF_KEYSTROKE,		16,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_APPS",		VK_APPS,			LOOKF_KEYSTROKE,		19,			VK_SHIFT},
	{"KEY_SHIFT_F01",		"KEY_SHIFT_F1",			VK_F1,				LOOKF_KEYSTROKE,		35,			VK_SHIFT},
	{"KEY_SHIFT_F02",		"KEY_SHIFT_F2",			VK_F2,				LOOKF_KEYSTROKE,		36,			VK_SHIFT},
	{"KEY_SHIFT_F03",		"KEY_SHIFT_F3",			VK_F3,				LOOKF_KEYSTROKE,		37,			VK_SHIFT},
	{"KEY_SHIFT_F04",		"KEY_SHIFT_F4",			VK_F4,				LOOKF_KEYSTROKE,		38,			VK_SHIFT},
	{"KEY_SHIFT_F05",		"KEY_SHIFT_F5",			VK_F5,				LOOKF_KEYSTROKE,		39,			VK_SHIFT},
	{"KEY_SHIFT_F06",		"KEY_SHIFT_F6",			VK_F6,				LOOKF_KEYSTROKE,		40,			VK_SHIFT},
	{"KEY_SHIFT_F07",		"KEY_SHIFT_F7",			VK_F7,				LOOKF_KEYSTROKE,		41,			VK_SHIFT},
	{"KEY_SHIFT_F08",		"KEY_SHIFT_F8",			VK_F8,				LOOKF_KEYSTROKE,		42,			VK_SHIFT},
	{"KEY_SHIFT_F09",		"KEY_SHIFT_F9",			VK_F9,				LOOKF_KEYSTROKE,		43,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_F10",		VK_F10,				LOOKF_KEYSTROKE,		44,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_F11",		VK_F11,				LOOKF_KEYSTROKE,		45,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_F12",		VK_F12,				LOOKF_KEYSTROKE,		46,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_NUMLOCK",	VK_NUMLOCK,			LOOKF_KEYSTROKE,		47,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_SCROLL",		VK_SCROLL,			LOOKF_KEYSTROKE,		48,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_0",			'0',				LOOKF_KEYSTROKE,		49,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_1",			'1',				LOOKF_KEYSTROKE,		50,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_2",			'2',				LOOKF_KEYSTROKE,		51,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_3",			'3',				LOOKF_KEYSTROKE,		52,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_4",			'4',				LOOKF_KEYSTROKE,		53,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_5",			'5',				LOOKF_KEYSTROKE,		54,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_6",			'6',				LOOKF_KEYSTROKE,		55,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_7",			'7',				LOOKF_KEYSTROKE,		56,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_8",			'8',				LOOKF_KEYSTROKE,		57,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_9",			'9',				LOOKF_KEYSTROKE,		58,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_A",			VK_A_GR,			LOOKF_KEYSTROKE,		59,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_B",			VK_B_GR,			LOOKF_KEYSTROKE,		60,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_C",			VK_C_GR,			LOOKF_KEYSTROKE,		61,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_D",			VK_D_GR,			LOOKF_KEYSTROKE,		62,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_E",			VK_E_GR,			LOOKF_KEYSTROKE,		63,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_F",			VK_F_GR,			LOOKF_KEYSTROKE,		64,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_G",			VK_G_GR,			LOOKF_KEYSTROKE,		65,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_H",			VK_H_GR,			LOOKF_KEYSTROKE,		66,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_I",			VK_I_GR,			LOOKF_KEYSTROKE,		67,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_J",			VK_J_GR,			LOOKF_KEYSTROKE,		68,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_K",			VK_K_GR,			LOOKF_KEYSTROKE,		69,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_L",			VK_L_GR,			LOOKF_KEYSTROKE,		70,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_M",			VK_M_GR,			LOOKF_KEYSTROKE,		71,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_N",			VK_N_GR,			LOOKF_KEYSTROKE,		72,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_O",			VK_O_GR,			LOOKF_KEYSTROKE,		73,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_P",			VK_P_GR,			LOOKF_KEYSTROKE,		74,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_Q",			VK_Q_GR,			LOOKF_KEYSTROKE,		75,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_R",			VK_R_GR,			LOOKF_KEYSTROKE,		76,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_S",			VK_S_GR,			LOOKF_KEYSTROKE,		77,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_T",			VK_T_GR,			LOOKF_KEYSTROKE,		78,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_U",			VK_U_GR,			LOOKF_KEYSTROKE,		79,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_V",			VK_V_GR,			LOOKF_KEYSTROKE,		80,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_W",			VK_W_GR,			LOOKF_KEYSTROKE,		81,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_X",			VK_X_GR,			LOOKF_KEYSTROKE,		82,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_Y",			VK_Y_GR,			LOOKF_KEYSTROKE,		83,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_Z",			VK_Z_GR,			LOOKF_KEYSTROKE,		84,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_MINUS",		VK_MINUS_GR,		LOOKF_KEYSTROKE,		32,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_OMLATO",		VK_OMLATO_GR,		LOOKF_KEYSTROKE,		141,		VK_SHIFT},
	{NULL,					"KEY_SHIFT_OMLATA",		VK_OMLATA_GR,		LOOKF_KEYSTROKE,		143,		VK_SHIFT},
	{NULL,					"KEY_SHIFT_OMLATU",		VK_OMLATU_GR,		LOOKF_KEYSTROKE,		142,		VK_SHIFT},
	{NULL,					"KEY_SHIFT_PLUS",		VK_PLUS_GR,			LOOKF_KEYSTROKE,		31,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_BETA",		VK_BETA_GR,			LOOKF_KEYSTROKE,		144,		VK_SHIFT},
	{NULL,					"KEY_SHIFT_ACCENT",		VK_ACCENT_GR,		LOOKF_KEYSTROKE,		128,		VK_SHIFT},
	{NULL,					"KEY_SHIFT_PERIOD",		VK_PERIOD_GR,		LOOKF_KEYSTROKE,		33,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_COMMA",		VK_COMMA_GR,		LOOKF_KEYSTROKE,		127,		VK_SHIFT},
	{NULL,					"KEY_SHIFT_POUND",		VK_POUND_GR,		LOOKF_KEYSTROKE,		140,		VK_SHIFT},
	{NULL,					"KEY_SHIFT_LESSTHAN",	VK_LESSTHAN_GR,		LOOKF_KEYSTROKE,		145,		VK_SHIFT},
	{NULL,					"KEY_SHIFT_SEMICOLON",	VK_SEMICOLON_GR,	LOOKF_KEYSTROKE,		125,		VK_SHIFT},
	{NULL,					"KEY_SHIFT_CARROT",		VK_CARROT_GR,		LOOKF_KEYSTROKE,		136,		VK_SHIFT},

	{NULL,NULL,0,0,0}
};

VKLOOKUP vkLookup_eng[] = {
//
// Regular keys mappings
//
	{NULL,					"KEY_BACKSPACE",		VK_BACK,			LOOKF_KEYSTROKE,		0,			0},
	{NULL,					"KEY_TAB",				VK_TAB,				LOOKF_KEYSTROKE,		1,			0},
	{NULL,					"KEY_RETURN",			VK_RETURN,			LOOKF_KEYSTROKE,		2,			0},
	{NULL,					"KEY_ENTER",			VK_RETURN,			LOOKF_KEYSTROKE,		2,			0},
	{NULL,					"KEY_CAPS",				VK_CAPITAL,			LOOKF_KEYSTROKE,		5,			0},
	{NULL,					"KEY_SPACE",			VK_SPACE,			LOOKF_KEYSTROKE,		6,			0},
	{NULL,					"KEY_SPACEBAR",			VK_SPACE,			LOOKF_KEYSTROKE,		6,			0},
	{NULL,					"KEY_PGUP",				VK_PRIOR,			LOOKF_KEYSTROKE,		7,			0},
	{NULL,					"KEY_PAGEUP",			VK_PRIOR,			LOOKF_KEYSTROKE,		7,			0},
	{NULL,					"KEY_PGDN",				VK_NEXT,			LOOKF_KEYSTROKE,		8,			0},
	{NULL,					"KEY_PAGEDOWN",			VK_NEXT,			LOOKF_KEYSTROKE,		8,			0},
	{NULL,					"KEY_HOME",				VK_HOME,			LOOKF_KEYSTROKE,		9,			0},
	{NULL,					"KEY_END",				VK_END,				LOOKF_KEYSTROKE,		10,			0},
	{NULL,					"KEY_LEFT",				VK_LEFT,			LOOKF_KEYSTROKE,		11,			0},
	{NULL,					"KEY_UP",				VK_UP,				LOOKF_KEYSTROKE,		12,			0},
	{NULL,					"KEY_RIGHT",			VK_RIGHT,			LOOKF_KEYSTROKE,		13,			0},
	{NULL,					"KEY_DOWN",				VK_DOWN,			LOOKF_KEYSTROKE,		14,			0},
	{NULL,					"KEY_INS",				VK_INSERT,			LOOKF_KEYSTROKE,		15,			0},
	{NULL,					"KEY_INSERT",			VK_INSERT,			LOOKF_KEYSTROKE,		15,			0},
	{NULL,					"KEY_DEL",				VK_DELETE,			LOOKF_KEYSTROKE,		16,			0},
	{NULL,					"KEY_DELETE",			VK_DELETE,			LOOKF_KEYSTROKE,		16,			0},
	{NULL,					"KEY_APPS",				VK_APPS,			LOOKF_KEYSTROKE,		19,			0},
	{NULL,					"KEY_NUMPAD0",			VK_NUMPAD0,			LOOKF_KEYSTROKE,		20,			0},
	{NULL,					"KEY_NUMPAD1",			VK_NUMPAD1,			LOOKF_KEYSTROKE,		21,			0},
	{NULL,					"KEY_NUMPAD2",			VK_NUMPAD2,			LOOKF_KEYSTROKE,		22,			0},
	{NULL,					"KEY_NUMPAD3",			VK_NUMPAD3,			LOOKF_KEYSTROKE,		23,			0},
	{NULL,					"KEY_NUMPAD4",			VK_NUMPAD4,			LOOKF_KEYSTROKE,		24,			0},
	{NULL,					"KEY_NUMPAD5",			VK_NUMPAD5,			LOOKF_KEYSTROKE,		25,			0},
	{NULL,					"KEY_NUMPAD6",			VK_NUMPAD6,			LOOKF_KEYSTROKE,		26,			0},
	{NULL,					"KEY_NUMPAD7",			VK_NUMPAD7,			LOOKF_KEYSTROKE,		27,			0},
	{NULL,					"KEY_NUMPAD8",			VK_NUMPAD8,			LOOKF_KEYSTROKE,		28,			0},
	{NULL,					"KEY_NUMPAD9",			VK_NUMPAD9,			LOOKF_KEYSTROKE,		29,			0},
	{NULL,					"KEY_MULTIPLY",			VK_MULTIPLY,		LOOKF_KEYSTROKE,		30,			0},
	{NULL,					"KEY_ADD",				VK_ADD,				LOOKF_KEYSTROKE,		31,			0},
	{NULL,					"KEY_SUBTRACT",			VK_SUBTRACT,		LOOKF_KEYSTROKE,		32,			0},
	{NULL,					"KEY_SUB",				VK_SUBTRACT,		LOOKF_KEYSTROKE,		32,			0},
	{NULL,					"KEY_DECIMAL",			VK_DECIMAL,			LOOKF_KEYSTROKE,		33,			0},
	{NULL,					"KEY_DIVIDE",			VK_DIVIDE,			LOOKF_KEYSTROKE,		34,			0},
	{"KEY_F01",				"KEY_F1",				VK_F1,				LOOKF_KEYSTROKE,		35,			0},
	{"KEY_F02",				"KEY_F2",				VK_F2,				LOOKF_KEYSTROKE,		36,			0},
	{"KEY_F03",				"KEY_F3",				VK_F3,				LOOKF_KEYSTROKE,		37,			0},
	{"KEY_F04",				"KEY_F4",				VK_F4,				LOOKF_KEYSTROKE,		38,			0},
	{"KEY_F05",				"KEY_F5",				VK_F5,				LOOKF_KEYSTROKE,		39,			0},
	{"KEY_F06",				"KEY_F6",				VK_F6,				LOOKF_KEYSTROKE,		40,			0},
	{"KEY_F07",				"KEY_F7",				VK_F7,				LOOKF_KEYSTROKE,		41,			0},
	{"KEY_F08",				"KEY_F8",				VK_F8,				LOOKF_KEYSTROKE,		42,			0},
	{"KEY_F09",				"KEY_F9",				VK_F9,				LOOKF_KEYSTROKE,		43,			0},
	{NULL,					"KEY_F10",				VK_F10,				LOOKF_KEYSTROKE,		44,			0},
	{NULL,					"KEY_F11",				VK_F11,				LOOKF_KEYSTROKE,		45,			0},
	{NULL,					"KEY_F12",				VK_F12,				LOOKF_KEYSTROKE,		46,			0},
	{NULL,					"KEY_NUMLOCK",			VK_NUMLOCK,			LOOKF_KEYSTROKE,		47,			0},
	{NULL,					"KEY_SCROLL",			VK_SCROLL,			LOOKF_KEYSTROKE,		48,			0},
	{NULL,					"KEY_0",				'0',				LOOKF_KEYSTROKE,		49,			0},
	{NULL,					"KEY_1",				'1',				LOOKF_KEYSTROKE,		50,			0},
	{NULL,					"KEY_2",				'2',				LOOKF_KEYSTROKE,		51,			0},
	{NULL,					"KEY_3",				'3',				LOOKF_KEYSTROKE,		52,			0},
	{NULL,					"KEY_4",				'4',				LOOKF_KEYSTROKE,		53,			0},
	{NULL,					"KEY_5",				'5',				LOOKF_KEYSTROKE,		54,			0},
	{NULL,					"KEY_6",				'6',				LOOKF_KEYSTROKE,		55,			0},
	{NULL,					"KEY_7",				'7',				LOOKF_KEYSTROKE,		56,			0},
	{NULL,					"KEY_8",				'8',				LOOKF_KEYSTROKE,		57,			0},
	{NULL,					"KEY_9",				'9',				LOOKF_KEYSTROKE,		58,			0},
	{NULL,					"KEY_A",				VK_A,				LOOKF_KEYSTROKE,		59,			0},
	{NULL,					"KEY_B",				VK_B,				LOOKF_KEYSTROKE,		60,			0},
	{NULL,					"KEY_C",				VK_C,				LOOKF_KEYSTROKE,		61,			0},
	{NULL,					"KEY_D",				VK_D,				LOOKF_KEYSTROKE,		62,			0},
	{NULL,					"KEY_E",				VK_E,				LOOKF_KEYSTROKE,		63,			0},
	{NULL,					"KEY_F",				VK_F,				LOOKF_KEYSTROKE,		64,			0},
	{NULL,					"KEY_G",				VK_G,				LOOKF_KEYSTROKE,		65,			0},
	{NULL,					"KEY_H",				VK_H,				LOOKF_KEYSTROKE,		66,			0},
	{NULL,					"KEY_I",				VK_I,				LOOKF_KEYSTROKE,		67,			0},
	{NULL,					"KEY_J",				VK_J,				LOOKF_KEYSTROKE,		68,			0},
	{NULL,					"KEY_K",				VK_K,				LOOKF_KEYSTROKE,		69,			0},
	{NULL,					"KEY_L",				VK_L,				LOOKF_KEYSTROKE,		70,			0},
	{NULL,					"KEY_M",				VK_M,				LOOKF_KEYSTROKE,		71,			0},
	{NULL,					"KEY_N",				VK_N,				LOOKF_KEYSTROKE,		72,			0},
	{NULL,					"KEY_O",				VK_O,				LOOKF_KEYSTROKE,		73,			0},
	{NULL,					"KEY_P",				VK_P,				LOOKF_KEYSTROKE,		74,			0},
	{NULL,					"KEY_Q",				VK_Q,				LOOKF_KEYSTROKE,		75,			0},
	{NULL,					"KEY_R",				VK_R,				LOOKF_KEYSTROKE,		76,			0},
	{NULL,					"KEY_S",				VK_S,				LOOKF_KEYSTROKE,		77,			0},
	{NULL,					"KEY_T",				VK_T,				LOOKF_KEYSTROKE,		78,			0},
	{NULL,					"KEY_U",				VK_U,				LOOKF_KEYSTROKE,		79,			0},
	{NULL,					"KEY_V",				VK_V,				LOOKF_KEYSTROKE,		80,			0},
	{NULL,					"KEY_W",				VK_W,				LOOKF_KEYSTROKE,		81,			0},
	{NULL,					"KEY_X",				VK_X,				LOOKF_KEYSTROKE,		82,			0},
	{NULL,					"KEY_Y",				VK_Y,				LOOKF_KEYSTROKE,		83,			0},
	{NULL,					"KEY_Z",				VK_Z,				LOOKF_KEYSTROKE,		84,			0},
	{"JOY1_BUTTON01",		"JOY1_BUTTON1",			JOY_BUTTON1,		LOOKF_JOY1,				85,			0},
	{"JOY1_BUTTON02",		"JOY1_BUTTON2",			JOY_BUTTON2,		LOOKF_JOY1,				86,			0},
	{"JOY1_BUTTON03",		"JOY1_BUTTON3",			JOY_BUTTON3,		LOOKF_JOY1,				87,			0},
	{"JOY1_BUTTON04",		"JOY1_BUTTON4",			JOY_BUTTON4,		LOOKF_JOY1,				88,			0},
	{"JOY1_BUTTON05",		"JOY1_BUTTON5",			JOY_BUTTON5,		LOOKF_JOY1,				89,			0},
	{"JOY1_BUTTON06",		"JOY1_BUTTON6",			JOY_BUTTON6,		LOOKF_JOY1,				90,			0},
	{"JOY1_BUTTON07",		"JOY1_BUTTON7",			JOY_BUTTON7,		LOOKF_JOY1,				91,			0},
	{"JOY1_BUTTON08",		"JOY1_BUTTON8",			JOY_BUTTON8,		LOOKF_JOY1,				92,			0},
	{"JOY1_BUTTON09",		"JOY1_BUTTON9",			JOY_BUTTON9,		LOOKF_JOY1,				93,			0},
	{NULL,					"JOY1_BUTTON10",		JOY_BUTTON10,		LOOKF_JOY1,				94,			0},
	{NULL,					"JOY1_BUTTON11",		JOY_BUTTON11,		LOOKF_JOY1,				95,			0},
	{NULL,					"JOY1_BUTTON12",		JOY_BUTTON12,		LOOKF_JOY1,				96,			0},
	{NULL,					"JOY1_BUTTON13",		JOY_BUTTON13,		LOOKF_JOY1,				97,			0},
	{NULL,					"JOY1_BUTTON14",		JOY_BUTTON14,		LOOKF_JOY1,				98,			0},
	{NULL,					"JOY1_BUTTON15",		JOY_BUTTON15,		LOOKF_JOY1,				99,			0},
	{NULL,					"JOY1_BUTTON16",		JOY_BUTTON16,		LOOKF_JOY1,				100,		0},
	{"JOY2_BUTTON01",		"JOY2_BUTTON1",			JOY_BUTTON1,		LOOKF_JOY2,				101,		0},
	{"JOY2_BUTTON02",		"JOY2_BUTTON2",			JOY_BUTTON2,		LOOKF_JOY2,				102,		0},
	{"JOY2_BUTTON03",		"JOY2_BUTTON3",			JOY_BUTTON3,		LOOKF_JOY2,				103,		0},
	{"JOY2_BUTTON04",		"JOY2_BUTTON4",			JOY_BUTTON4,		LOOKF_JOY2,				104,		0},
	{"JOY2_BUTTON05",		"JOY2_BUTTON5",			JOY_BUTTON5,		LOOKF_JOY2,				105,		0},
	{"JOY2_BUTTON06",		"JOY2_BUTTON6",			JOY_BUTTON6,		LOOKF_JOY2,				106,		0},
	{"JOY2_BUTTON07",		"JOY2_BUTTON7",			JOY_BUTTON7,		LOOKF_JOY2,				107,		0},
	{"JOY2_BUTTON08",		"JOY2_BUTTON8",			JOY_BUTTON8,		LOOKF_JOY2,				108,		0},
	{"JOY2_BUTTON09",		"JOY2_BUTTON9",			JOY_BUTTON9,		LOOKF_JOY2,				109,		0},
	{NULL,					"JOY2_BUTTON10",		JOY_BUTTON10,		LOOKF_JOY2,				110,		0},
	{NULL,					"JOY2_BUTTON11",		JOY_BUTTON11,		LOOKF_JOY2,				111,		0},
	{NULL,					"JOY2_BUTTON12",		JOY_BUTTON12,		LOOKF_JOY2,				112,		0},
	{NULL,					"JOY2_BUTTON13",		JOY_BUTTON13,		LOOKF_JOY2,				113,		0},
	{NULL,					"JOY2_BUTTON14",		JOY_BUTTON14,		LOOKF_JOY2,				114,		0},
	{NULL,					"JOY2_BUTTON15",		JOY_BUTTON15,		LOOKF_JOY2,				115,		0},
	{NULL,					"JOY2_BUTTON16",		JOY_BUTTON16,		LOOKF_JOY2,				116,		0},
	{NULL,					"JOY1_HATUP",			JOY_POVFORWARD,		LOOKF_JOYHAT1,			117,		0},
	{NULL,					"JOY1_HATRIGHT",		JOY_POVRIGHT,		LOOKF_JOYHAT1,			118,		0},
	{NULL,					"JOY1_HATDOWN",			JOY_POVBACKWARD,	LOOKF_JOYHAT1,			119,		0},
	{NULL,					"JOY1_HATLEFT",			JOY_POVLEFT,		LOOKF_JOYHAT1,			120,		0},
	{NULL,					"JOY2_HATUP",			JOY_POVFORWARD,		LOOKF_JOYHAT2,			121,		0},
	{NULL,					"JOY2_HATRIGHT",		JOY_POVRIGHT,		LOOKF_JOYHAT2,			122,		0},
	{NULL,					"JOY2_HATDOWN",			JOY_POVBACKWARD,	LOOKF_JOYHAT2,			123,		0},
	{NULL,					"JOY2_HATLEFT",			JOY_POVLEFT,		LOOKF_JOYHAT2,			124,		0},
	{NULL,					"KEY_SEMICOLON",		VK_SEMICOLON,		LOOKF_KEYSTROKE,		125,		0},
	{NULL,					"KEY_EQUAL",			VK_EQUAL,			LOOKF_KEYSTROKE,		126,		0},
	{NULL,					"KEY_COMMA",			VK_COMMA,			LOOKF_KEYSTROKE,		127,		0},
	{NULL,					"KEY_MINUS",			VK_MINUS,			LOOKF_KEYSTROKE,		32,			0},
	{NULL,					"KEY_PERIOD",			VK_PERIOD,			LOOKF_KEYSTROKE,		33,			0},
	{NULL,					"KEY_ACCENT",			VK_ACCENT,			LOOKF_KEYSTROKE,		128,		0},
	{NULL,					"KEY_LBRACKET",			VK_LBRACKET,		LOOKF_KEYSTROKE,		129,		0},
	{NULL,					"KEY_RBRACKET",			VK_RBRACKET,		LOOKF_KEYSTROKE,		130,		0},
	{NULL,					"KEY_APOSTROPHE",		VK_APOSTROPHE,		LOOKF_KEYSTROKE,		131,		0},
	{NULL,					"KEY_BACK_SLASH",		VK_BACK_SLASH,		LOOKF_KEYSTROKE,		34,			0},
	{NULL,					"KEY_SLASH",			VK_SLASH,			LOOKF_KEYSTROKE,		132,		0},

//
// CTRL keys mappings
//
	{NULL,					"KEY_CTRL_BKSPC",		VK_BACK,			LOOKF_KEYSTROKE,		0,			VK_CONTROL},
	{NULL,					"KEY_CTRL_TAB",			VK_TAB,				LOOKF_KEYSTROKE,		1,			VK_CONTROL},
	{NULL,					"KEY_CTRL_RETURN",		VK_RETURN,			LOOKF_KEYSTROKE,		2,			VK_CONTROL},
	{NULL,					"KEY_CTRL_ENTER",		VK_RETURN,			LOOKF_KEYSTROKE,		2,			VK_CONTROL},
	{NULL,					"KEY_CTRL_SPACE",		VK_SPACE,			LOOKF_KEYSTROKE,		6,			VK_CONTROL},
	{NULL,					"KEY_CTRL_SPACEBAR",	VK_SPACE,			LOOKF_KEYSTROKE,		6,			VK_CONTROL},
	{NULL,					"KEY_CTRL_PGUP",		VK_PRIOR,			LOOKF_KEYSTROKE,		7,			VK_CONTROL},
	{NULL,					"KEY_CTRL_PAGEUP",		VK_PRIOR,			LOOKF_KEYSTROKE,		7,			VK_CONTROL},
	{NULL,					"KEY_CTRL_PGDN",		VK_NEXT,			LOOKF_KEYSTROKE,		8,			VK_CONTROL},
	{NULL,					"KEY_CTRL_PAGEDOWN",	VK_NEXT,			LOOKF_KEYSTROKE,		8,			VK_CONTROL},
	{NULL,					"KEY_CTRL_HOME",		VK_HOME,			LOOKF_KEYSTROKE,		9,			VK_CONTROL},
	{NULL,					"KEY_CTRL_END",			VK_END,				LOOKF_KEYSTROKE,		10,			VK_CONTROL},
	{NULL,					"KEY_CTRL_LEFT",		VK_LEFT,			LOOKF_KEYSTROKE,		11,			VK_CONTROL},
	{NULL,					"KEY_CTRL_UP",			VK_UP,				LOOKF_KEYSTROKE,		12,			VK_CONTROL},
	{NULL,					"KEY_CTRL_RIGHT",		VK_RIGHT,			LOOKF_KEYSTROKE,		13,			VK_CONTROL},
	{NULL,					"KEY_CTRL_DOWN",		VK_DOWN,			LOOKF_KEYSTROKE,		14,			VK_CONTROL},
	{NULL,					"KEY_CTRL_INS",			VK_INSERT,			LOOKF_KEYSTROKE,		15,			VK_CONTROL},
	{NULL,					"KEY_CTRL_INSERT",		VK_INSERT,			LOOKF_KEYSTROKE,		15,			VK_CONTROL},
	{NULL,					"KEY_CTRL_DEL",			VK_DELETE,			LOOKF_KEYSTROKE,		16,			VK_CONTROL},
	{NULL,					"KEY_CTRL_DELETE",		VK_DELETE,			LOOKF_KEYSTROKE,		16,			VK_CONTROL},
	{NULL,					"KEY_CTRL_APPS",		VK_APPS,			LOOKF_KEYSTROKE,		19,			VK_CONTROL},
	{"KEY_CTRL_F01",		"KEY_CTRL_F1",			VK_F1,				LOOKF_KEYSTROKE,		35,			VK_CONTROL},
	{"KEY_CTRL_F02",		"KEY_CTRL_F2",			VK_F2,				LOOKF_KEYSTROKE,		36,			VK_CONTROL},
	{"KEY_CTRL_F03",		"KEY_CTRL_F3",			VK_F3,				LOOKF_KEYSTROKE,		37,			VK_CONTROL},
	{"KEY_CTRL_F04",		"KEY_CTRL_F4",			VK_F4,				LOOKF_KEYSTROKE,		38,			VK_CONTROL},
	{"KEY_CTRL_F05",		"KEY_CTRL_F5",			VK_F5,				LOOKF_KEYSTROKE,		39,			VK_CONTROL},
	{"KEY_CTRL_F06",		"KEY_CTRL_F6",			VK_F6,				LOOKF_KEYSTROKE,		40,			VK_CONTROL},
	{"KEY_CTRL_F07",		"KEY_CTRL_F7",			VK_F7,				LOOKF_KEYSTROKE,		41,			VK_CONTROL},
	{"KEY_CTRL_F08",		"KEY_CTRL_F8",			VK_F8,				LOOKF_KEYSTROKE,		42,			VK_CONTROL},
	{"KEY_CTRL_F09",		"KEY_CTRL_F9",			VK_F9,				LOOKF_KEYSTROKE,		43,			VK_CONTROL},
	{NULL,					"KEY_CTRL_F10",			VK_F10,				LOOKF_KEYSTROKE,		44,			VK_CONTROL},
	{NULL,					"KEY_CTRL_F11",			VK_F11,				LOOKF_KEYSTROKE,		45,			VK_CONTROL},
	{NULL,					"KEY_CTRL_F12",			VK_F12,				LOOKF_KEYSTROKE,		46,			VK_CONTROL},
	{NULL,					"KEY_CTRL_NUMLOCK",		VK_NUMLOCK,			LOOKF_KEYSTROKE,		47,			VK_CONTROL},
	{NULL,					"KEY_CTRL_SCROLL",		VK_SCROLL,			LOOKF_KEYSTROKE,		48,			VK_CONTROL},
	{NULL,					"KEY_CTRL_0",			'0',				LOOKF_KEYSTROKE,		49,			VK_CONTROL},
	{NULL,					"KEY_CTRL_1",			'1',				LOOKF_KEYSTROKE,		50,			VK_CONTROL},
	{NULL,					"KEY_CTRL_2",			'2',				LOOKF_KEYSTROKE,		51,			VK_CONTROL},
	{NULL,					"KEY_CTRL_3",			'3',				LOOKF_KEYSTROKE,		52,			VK_CONTROL},
	{NULL,					"KEY_CTRL_4",			'4',				LOOKF_KEYSTROKE,		53,			VK_CONTROL},
	{NULL,					"KEY_CTRL_5",			'5',				LOOKF_KEYSTROKE,		54,			VK_CONTROL},
	{NULL,					"KEY_CTRL_6",			'6',				LOOKF_KEYSTROKE,		55,			VK_CONTROL},
	{NULL,					"KEY_CTRL_7",			'7',				LOOKF_KEYSTROKE,		56,			VK_CONTROL},
	{NULL,					"KEY_CTRL_8",			'8',				LOOKF_KEYSTROKE,		57,			VK_CONTROL},
	{NULL,					"KEY_CTRL_9",			'9',				LOOKF_KEYSTROKE,		58,			VK_CONTROL},
	{NULL,					"KEY_CTRL_A",			VK_A,				LOOKF_KEYSTROKE,		59,			VK_CONTROL},
	{NULL,					"KEY_CTRL_B",			VK_B,				LOOKF_KEYSTROKE,		60,			VK_CONTROL},
	{NULL,					"KEY_CTRL_C",			VK_C,				LOOKF_KEYSTROKE,		61,			VK_CONTROL},
	{NULL,					"KEY_CTRL_D",			VK_D,				LOOKF_KEYSTROKE,		62,			VK_CONTROL},
	{NULL,					"KEY_CTRL_E",			VK_E,				LOOKF_KEYSTROKE,		63,			VK_CONTROL},
	{NULL,					"KEY_CTRL_F",			VK_F,				LOOKF_KEYSTROKE,		64,			VK_CONTROL},
	{NULL,					"KEY_CTRL_G",			VK_G,				LOOKF_KEYSTROKE,		65,			VK_CONTROL},
	{NULL,					"KEY_CTRL_H",			VK_H,				LOOKF_KEYSTROKE,		66,			VK_CONTROL},
	{NULL,					"KEY_CTRL_I",			VK_I,				LOOKF_KEYSTROKE,		67,			VK_CONTROL},
	{NULL,					"KEY_CTRL_J",			VK_J,				LOOKF_KEYSTROKE,		68,			VK_CONTROL},
	{NULL,					"KEY_CTRL_K",			VK_K,				LOOKF_KEYSTROKE,		69,			VK_CONTROL},
	{NULL,					"KEY_CTRL_L",			VK_L,				LOOKF_KEYSTROKE,		70,			VK_CONTROL},
	{NULL,					"KEY_CTRL_M",			VK_M,				LOOKF_KEYSTROKE,		71,			VK_CONTROL},
	{NULL,					"KEY_CTRL_N",			VK_N,				LOOKF_KEYSTROKE,		72,			VK_CONTROL},
	{NULL,					"KEY_CTRL_O",			VK_O,				LOOKF_KEYSTROKE,		73,			VK_CONTROL},
	{NULL,					"KEY_CTRL_P",			VK_P,				LOOKF_KEYSTROKE,		74,			VK_CONTROL},
	{NULL,					"KEY_CTRL_Q",			VK_Q,				LOOKF_KEYSTROKE,		75,			VK_CONTROL},
	{NULL,					"KEY_CTRL_R",			VK_R,				LOOKF_KEYSTROKE,		76,			VK_CONTROL},
	{NULL,					"KEY_CTRL_S",			VK_S,				LOOKF_KEYSTROKE,		77,			VK_CONTROL},
	{NULL,					"KEY_CTRL_T",			VK_T,				LOOKF_KEYSTROKE,		78,			VK_CONTROL},
	{NULL,					"KEY_CTRL_U",			VK_U,				LOOKF_KEYSTROKE,		79,			VK_CONTROL},
	{NULL,					"KEY_CTRL_V",			VK_V,				LOOKF_KEYSTROKE,		80,			VK_CONTROL},
	{NULL,					"KEY_CTRL_W",			VK_W,				LOOKF_KEYSTROKE,		81,			VK_CONTROL},
	{NULL,					"KEY_CTRL_X",			VK_X,				LOOKF_KEYSTROKE,		82,			VK_CONTROL},
	{NULL,					"KEY_CTRL_Y",			VK_Y,				LOOKF_KEYSTROKE,		83,			VK_CONTROL},
	{NULL,					"KEY_CTRL_Z",			VK_Z,				LOOKF_KEYSTROKE,		84,			VK_CONTROL},
	{NULL,					"KEY_CTRL_SEMICOLON",	VK_SEMICOLON,		LOOKF_KEYSTROKE,		125,		VK_CONTROL},
	{NULL,					"KEY_CTRL_EQUAL",		VK_EQUAL,			LOOKF_KEYSTROKE,		126,		VK_CONTROL},
	{NULL,					"KEY_CTRL_COMMA",		VK_COMMA,			LOOKF_KEYSTROKE,		127,		VK_CONTROL},
	{NULL,					"KEY_CTRL_MINUS",		VK_MINUS,			LOOKF_KEYSTROKE,		32,			VK_CONTROL},
	{NULL,					"KEY_CTRL_PERIOD",		VK_PERIOD,			LOOKF_KEYSTROKE,		33,			VK_CONTROL},
	{NULL,					"KEY_CTRL_ACCENT",		VK_ACCENT,			LOOKF_KEYSTROKE,		128,		VK_CONTROL},
	{NULL,					"KEY_CTRL_LBRACKET",	VK_LBRACKET,		LOOKF_KEYSTROKE,		129,		VK_CONTROL},
	{NULL,					"KEY_CTRL_RBRACKET",	VK_RBRACKET,		LOOKF_KEYSTROKE,		130,		VK_CONTROL},
	{NULL,					"KEY_CTRL_APOSTROPHE",	VK_APOSTROPHE,		LOOKF_KEYSTROKE,		131,		VK_CONTROL},
	{NULL,					"KEY_CTRL_BACK_SLASH",	VK_BACK_SLASH,		LOOKF_KEYSTROKE,		34,			VK_CONTROL},
	{NULL,					"KEY_CTRL_SLASH",		VK_SLASH,			LOOKF_KEYSTROKE,		132,		VK_CONTROL},

//
// ALT keys mappings
//
	{NULL,					"KEY_ALT_BKSPC",		VK_BACK,			LOOKF_KEYSTROKE,		0,			VK_MENU},
	{NULL,					"KEY_ALT_TAB",			VK_TAB,				LOOKF_KEYSTROKE,		1,			VK_MENU},
	{NULL,					"KEY_ALT_RETURN",		VK_RETURN,			LOOKF_KEYSTROKE,		2,			VK_MENU},
	{NULL,					"KEY_ALT_ENTER",		VK_RETURN,			LOOKF_KEYSTROKE,		2,			VK_MENU},
	{NULL,					"KEY_ALT_SPACE",		VK_SPACE,			LOOKF_KEYSTROKE,		6,			VK_MENU},
	{NULL,					"KEY_ALT_SPACEBAR",		VK_SPACE,			LOOKF_KEYSTROKE,		6,			VK_MENU},
	{NULL,					"KEY_ALT_PGUP",			VK_PRIOR,			LOOKF_KEYSTROKE,		7,			VK_MENU},
	{NULL,					"KEY_ALT_PAGEUP",		VK_PRIOR,			LOOKF_KEYSTROKE,		7,			VK_MENU},
	{NULL,					"KEY_ALT_PGDN",			VK_NEXT,			LOOKF_KEYSTROKE,		8,			VK_MENU},
	{NULL,					"KEY_ALT_PAGEDOWN",		VK_NEXT,			LOOKF_KEYSTROKE,		8,			VK_MENU},
	{NULL,					"KEY_ALT_HOME",			VK_HOME,			LOOKF_KEYSTROKE,		9,			VK_MENU},
	{NULL,					"KEY_ALT_END",			VK_END,				LOOKF_KEYSTROKE,		10,			VK_MENU},
	{NULL,					"KEY_ALT_LEFT",			VK_LEFT,			LOOKF_KEYSTROKE,		11,			VK_MENU},
	{NULL,					"KEY_ALT_UP",			VK_UP,				LOOKF_KEYSTROKE,		12,			VK_MENU},
	{NULL,					"KEY_ALT_RIGHT",		VK_RIGHT,			LOOKF_KEYSTROKE,		13,			VK_MENU},
	{NULL,					"KEY_ALT_DOWN",			VK_DOWN,			LOOKF_KEYSTROKE,		14,			VK_MENU},
	{NULL,					"KEY_ALT_INS",			VK_INSERT,			LOOKF_KEYSTROKE,		15,			VK_MENU},
	{NULL,					"KEY_ALT_INSERT",		VK_INSERT,			LOOKF_KEYSTROKE,		15,			VK_MENU},
	{NULL,					"KEY_ALT_DEL",			VK_DELETE,			LOOKF_KEYSTROKE,		16,			VK_MENU},
	{NULL,					"KEY_ALT_DELETE",		VK_DELETE,			LOOKF_KEYSTROKE,		16,			VK_MENU},
	{NULL,					"KEY_ALT_APPS",			VK_APPS,			LOOKF_KEYSTROKE,		19,			VK_MENU},
	{"KEY_ALT_F01",			"KEY_ALT_F1",			VK_F1,				LOOKF_KEYSTROKE,		35,			VK_MENU},
	{"KEY_ALT_F02",			"KEY_ALT_F2",			VK_F2,				LOOKF_KEYSTROKE,		36,			VK_MENU},
	{"KEY_ALT_F03",			"KEY_ALT_F3",			VK_F3,				LOOKF_KEYSTROKE,		37,			VK_MENU},
	{"KEY_ALT_F04",			"KEY_ALT_F4",			VK_F4,				LOOKF_KEYSTROKE,		38,			VK_MENU},
	{"KEY_ALT_F05",			"KEY_ALT_F5",			VK_F5,				LOOKF_KEYSTROKE,		39,			VK_MENU},
	{"KEY_ALT_F06",			"KEY_ALT_F6",			VK_F6,				LOOKF_KEYSTROKE,		40,			VK_MENU},
	{"KEY_ALT_F07",			"KEY_ALT_F7",			VK_F7,				LOOKF_KEYSTROKE,		41,			VK_MENU},
	{"KEY_ALT_F08",			"KEY_ALT_F8",			VK_F8,				LOOKF_KEYSTROKE,		42,			VK_MENU},
	{"KEY_ALT_F09",			"KEY_ALT_F9",			VK_F9,				LOOKF_KEYSTROKE,		43,			VK_MENU},
	{NULL,					"KEY_ALT_F10",			VK_F10,				LOOKF_KEYSTROKE,		44,			VK_MENU},
	{NULL,					"KEY_ALT_F11",			VK_F11,				LOOKF_KEYSTROKE,		45,			VK_MENU},
	{NULL,					"KEY_ALT_F12",			VK_F12,				LOOKF_KEYSTROKE,		46,			VK_MENU},
	{NULL,					"KEY_ALT_NUMLOCK",		VK_NUMLOCK,			LOOKF_KEYSTROKE,		47,			VK_MENU},
	{NULL,					"KEY_ALT_SCROLL",		VK_SCROLL,			LOOKF_KEYSTROKE,		48,			VK_MENU},
	{NULL,					"KEY_ALT_0",			'0',				LOOKF_KEYSTROKE,		49,			VK_MENU},
	{NULL,					"KEY_ALT_1",			'1',				LOOKF_KEYSTROKE,		50,			VK_MENU},
	{NULL,					"KEY_ALT_2",			'2',				LOOKF_KEYSTROKE,		51,			VK_MENU},
	{NULL,					"KEY_ALT_3",			'3',				LOOKF_KEYSTROKE,		52,			VK_MENU},
	{NULL,					"KEY_ALT_4",			'4',				LOOKF_KEYSTROKE,		53,			VK_MENU},
	{NULL,					"KEY_ALT_5",			'5',				LOOKF_KEYSTROKE,		54,			VK_MENU},
	{NULL,					"KEY_ALT_6",			'6',				LOOKF_KEYSTROKE,		55,			VK_MENU},
	{NULL,					"KEY_ALT_7",			'7',				LOOKF_KEYSTROKE,		56,			VK_MENU},
	{NULL,					"KEY_ALT_8",			'8',				LOOKF_KEYSTROKE,		57,			VK_MENU},
	{NULL,					"KEY_ALT_9",			'9',				LOOKF_KEYSTROKE,		58,			VK_MENU},
	{NULL,					"KEY_ALT_A",			VK_A,				LOOKF_KEYSTROKE,		59,			VK_MENU},
	{NULL,					"KEY_ALT_B",			VK_B,				LOOKF_KEYSTROKE,		60,			VK_MENU},
	{NULL,					"KEY_ALT_C",			VK_C,				LOOKF_KEYSTROKE,		61,			VK_MENU},
	{NULL,					"KEY_ALT_D",			VK_D,				LOOKF_KEYSTROKE,		62,			VK_MENU},
	{NULL,					"KEY_ALT_E",			VK_E,				LOOKF_KEYSTROKE,		63,			VK_MENU},
	{NULL,					"KEY_ALT_F",			VK_F,				LOOKF_KEYSTROKE,		64,			VK_MENU},
	{NULL,					"KEY_ALT_G",			VK_G,				LOOKF_KEYSTROKE,		65,			VK_MENU},
	{NULL,					"KEY_ALT_H",			VK_H,				LOOKF_KEYSTROKE,		66,			VK_MENU},
	{NULL,					"KEY_ALT_I",			VK_I,				LOOKF_KEYSTROKE,		67,			VK_MENU},
	{NULL,					"KEY_ALT_J",			VK_J,				LOOKF_KEYSTROKE,		68,			VK_MENU},
	{NULL,					"KEY_ALT_K",			VK_K,				LOOKF_KEYSTROKE,		69,			VK_MENU},
	{NULL,					"KEY_ALT_L",			VK_L,				LOOKF_KEYSTROKE,		70,			VK_MENU},
	{NULL,					"KEY_ALT_M",			VK_M,				LOOKF_KEYSTROKE,		71,			VK_MENU},
	{NULL,					"KEY_ALT_N",			VK_N,				LOOKF_KEYSTROKE,		72,			VK_MENU},
	{NULL,					"KEY_ALT_O",			VK_O,				LOOKF_KEYSTROKE,		73,			VK_MENU},
	{NULL,					"KEY_ALT_P",			VK_P,				LOOKF_KEYSTROKE,		74,			VK_MENU},
	{NULL,					"KEY_ALT_Q",			VK_Q,				LOOKF_KEYSTROKE,		75,			VK_MENU},
	{NULL,					"KEY_ALT_R",			VK_R,				LOOKF_KEYSTROKE,		76,			VK_MENU},
	{NULL,					"KEY_ALT_S",			VK_S,				LOOKF_KEYSTROKE,		77,			VK_MENU},
	{NULL,					"KEY_ALT_T",			VK_T,				LOOKF_KEYSTROKE,		78,			VK_MENU},
	{NULL,					"KEY_ALT_U",			VK_U,				LOOKF_KEYSTROKE,		79,			VK_MENU},
	{NULL,					"KEY_ALT_V",			VK_V,				LOOKF_KEYSTROKE,		80,			VK_MENU},
	{NULL,					"KEY_ALT_W",			VK_W,				LOOKF_KEYSTROKE,		81,			VK_MENU},
	{NULL,					"KEY_ALT_X",			VK_X,				LOOKF_KEYSTROKE,		82,			VK_MENU},
	{NULL,					"KEY_ALT_Y",			VK_Y,				LOOKF_KEYSTROKE,		83,			VK_MENU},
	{NULL,					"KEY_ALT_Z",			VK_Z,				LOOKF_KEYSTROKE,		84,			VK_MENU},
	{NULL,					"KEY_ALT_SEMICOLON",	VK_SEMICOLON,		LOOKF_KEYSTROKE,		125,		VK_MENU},
	{NULL,					"KEY_ALT_EQUAL",		VK_EQUAL,			LOOKF_KEYSTROKE,		126,		VK_MENU},
	{NULL,					"KEY_ALT_COMMA",		VK_COMMA,			LOOKF_KEYSTROKE,		127,		VK_MENU},
	{NULL,					"KEY_ALT_MINUS",		VK_MINUS,			LOOKF_KEYSTROKE,		32,			VK_MENU},
	{NULL,					"KEY_ALT_PERIOD",		VK_PERIOD,			LOOKF_KEYSTROKE,		33,			VK_MENU},
	{NULL,					"KEY_ALT_ACCENT",		VK_ACCENT,			LOOKF_KEYSTROKE,		128,		VK_MENU},
	{NULL,					"KEY_ALT_LBRACKET",		VK_LBRACKET,		LOOKF_KEYSTROKE,		129,		VK_MENU},
	{NULL,					"KEY_ALT_RBRACKET",		VK_RBRACKET,		LOOKF_KEYSTROKE,		130,		VK_MENU},
	{NULL,					"KEY_ALT_APOSTROPHE",	VK_APOSTROPHE,		LOOKF_KEYSTROKE,		131,		VK_MENU},
	{NULL,					"KEY_ALT_BACK_SLASH",	VK_BACK_SLASH,		LOOKF_KEYSTROKE,		34,			VK_MENU},
	{NULL,					"KEY_ALT_SLASH",		VK_SLASH,			LOOKF_KEYSTROKE,		132,		VK_MENU},

//
// SHIFT keys mappings
//
	{NULL,					"KEY_SHIFT_BKSPC",		VK_BACK,			LOOKF_KEYSTROKE,		0,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_TAB",		VK_TAB,				LOOKF_KEYSTROKE,		1,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_RETURN",		VK_RETURN,			LOOKF_KEYSTROKE,		2,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_ENTER",		VK_RETURN,			LOOKF_KEYSTROKE,		2,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_SPACE",		VK_SPACE,			LOOKF_KEYSTROKE,		6,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_SPACEBAR",	VK_SPACE,			LOOKF_KEYSTROKE,		6,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_PGUP",		VK_PRIOR,			LOOKF_KEYSTROKE,		7,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_PAGEUP",		VK_PRIOR,			LOOKF_KEYSTROKE,		7,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_PGDN",		VK_NEXT,			LOOKF_KEYSTROKE,		8,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_PAGEDOWN",	VK_NEXT,			LOOKF_KEYSTROKE,		8,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_HOME",		VK_HOME,			LOOKF_KEYSTROKE,		9,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_END",		VK_END,				LOOKF_KEYSTROKE,		10,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_LEFT",		VK_LEFT,			LOOKF_KEYSTROKE,		11,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_UP",			VK_UP,				LOOKF_KEYSTROKE,		12,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_RIGHT",		VK_RIGHT,			LOOKF_KEYSTROKE,		13,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_DOWN",		VK_DOWN,			LOOKF_KEYSTROKE,		14,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_INS",		VK_INSERT,			LOOKF_KEYSTROKE,		15,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_INSERT",		VK_INSERT,			LOOKF_KEYSTROKE,		15,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_DEL",		VK_DELETE,			LOOKF_KEYSTROKE,		16,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_DELETE",		VK_DELETE,			LOOKF_KEYSTROKE,		16,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_APPS",		VK_APPS,			LOOKF_KEYSTROKE,		19,			VK_SHIFT},
	{"KEY_SHIFT_F01",		"KEY_SHIFT_F1",			VK_F1,				LOOKF_KEYSTROKE,		35,			VK_SHIFT},
	{"KEY_SHIFT_F02",		"KEY_SHIFT_F2",			VK_F2,				LOOKF_KEYSTROKE,		36,			VK_SHIFT},
	{"KEY_SHIFT_F03",		"KEY_SHIFT_F3",			VK_F3,				LOOKF_KEYSTROKE,		37,			VK_SHIFT},
	{"KEY_SHIFT_F04",		"KEY_SHIFT_F4",			VK_F4,				LOOKF_KEYSTROKE,		38,			VK_SHIFT},
	{"KEY_SHIFT_F05",		"KEY_SHIFT_F5",			VK_F5,				LOOKF_KEYSTROKE,		39,			VK_SHIFT},
	{"KEY_SHIFT_F06",		"KEY_SHIFT_F6",			VK_F6,				LOOKF_KEYSTROKE,		40,			VK_SHIFT},
	{"KEY_SHIFT_F07",		"KEY_SHIFT_F7",			VK_F7,				LOOKF_KEYSTROKE,		41,			VK_SHIFT},
	{"KEY_SHIFT_F08",		"KEY_SHIFT_F8",			VK_F8,				LOOKF_KEYSTROKE,		42,			VK_SHIFT},
	{"KEY_SHIFT_F09",		"KEY_SHIFT_F9",			VK_F9,				LOOKF_KEYSTROKE,		43,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_F10",		VK_F10,				LOOKF_KEYSTROKE,		44,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_F11",		VK_F11,				LOOKF_KEYSTROKE,		45,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_F12",		VK_F12,				LOOKF_KEYSTROKE,		46,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_NUMLOCK",	VK_NUMLOCK,			LOOKF_KEYSTROKE,		47,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_SCROLL",		VK_SCROLL,			LOOKF_KEYSTROKE,		48,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_0",			'0',				LOOKF_KEYSTROKE,		49,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_1",			'1',				LOOKF_KEYSTROKE,		50,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_2",			'2',				LOOKF_KEYSTROKE,		51,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_3",			'3',				LOOKF_KEYSTROKE,		52,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_4",			'4',				LOOKF_KEYSTROKE,		53,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_5",			'5',				LOOKF_KEYSTROKE,		54,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_6",			'6',				LOOKF_KEYSTROKE,		55,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_7",			'7',				LOOKF_KEYSTROKE,		56,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_8",			'8',				LOOKF_KEYSTROKE,		57,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_9",			'9',				LOOKF_KEYSTROKE,		58,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_A",			VK_A,				LOOKF_KEYSTROKE,		59,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_B",			VK_B,				LOOKF_KEYSTROKE,		60,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_C",			VK_C,				LOOKF_KEYSTROKE,		61,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_D",			VK_D,				LOOKF_KEYSTROKE,		62,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_E",			VK_E,				LOOKF_KEYSTROKE,		63,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_F",			VK_F,				LOOKF_KEYSTROKE,		64,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_G",			VK_G,				LOOKF_KEYSTROKE,		65,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_H",			VK_H,				LOOKF_KEYSTROKE,		66,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_I",			VK_I,				LOOKF_KEYSTROKE,		67,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_J",			VK_J,				LOOKF_KEYSTROKE,		68,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_K",			VK_K,				LOOKF_KEYSTROKE,		69,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_L",			VK_L,				LOOKF_KEYSTROKE,		70,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_M",			VK_M,				LOOKF_KEYSTROKE,		71,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_N",			VK_N,				LOOKF_KEYSTROKE,		72,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_O",			VK_O,				LOOKF_KEYSTROKE,		73,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_P",			VK_P,				LOOKF_KEYSTROKE,		74,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_Q",			VK_Q,				LOOKF_KEYSTROKE,		75,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_R",			VK_R,				LOOKF_KEYSTROKE,		76,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_S",			VK_S,				LOOKF_KEYSTROKE,		77,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_T",			VK_T,				LOOKF_KEYSTROKE,		78,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_U",			VK_U,				LOOKF_KEYSTROKE,		79,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_V",			VK_V,				LOOKF_KEYSTROKE,		80,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_W",			VK_W,				LOOKF_KEYSTROKE,		81,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_X",			VK_X,				LOOKF_KEYSTROKE,		82,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_Y",			VK_Y,				LOOKF_KEYSTROKE,		83,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_Z",			VK_Z,				LOOKF_KEYSTROKE,		84,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_SEMICOLON",	VK_SEMICOLON,		LOOKF_KEYSTROKE,		125,		VK_SHIFT},
	{NULL,					"KEY_SHIFT_EQUAL",		VK_EQUAL,			LOOKF_KEYSTROKE,		126,		VK_SHIFT},
	{NULL,					"KEY_SHIFT_COMMA",		VK_COMMA,			LOOKF_KEYSTROKE,		127,		VK_SHIFT},
	{NULL,					"KEY_SHIFT_MINUS",		VK_MINUS,			LOOKF_KEYSTROKE,		32,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_PERIOD",		VK_PERIOD,			LOOKF_KEYSTROKE,		33,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_ACCENT",		VK_ACCENT,			LOOKF_KEYSTROKE,		128,		VK_SHIFT},
	{NULL,					"KEY_SHIFT_LBRACKET",	VK_LBRACKET,		LOOKF_KEYSTROKE,		129,		VK_SHIFT},
	{NULL,					"KEY_SHIFT_RBRACKET",	VK_RBRACKET,		LOOKF_KEYSTROKE,		130,		VK_SHIFT},
	{NULL,					"KEY_SHIFT_APOSTROPHE",	VK_APOSTROPHE,		LOOKF_KEYSTROKE,		131,		VK_SHIFT},
	{NULL,					"KEY_SHIFT_BACK_SLASH",	VK_BACK_SLASH,		LOOKF_KEYSTROKE,		34,			VK_SHIFT},
	{NULL,					"KEY_SHIFT_SLASH",		VK_SLASH,			LOOKF_KEYSTROKE,		132,		VK_SHIFT},

	{NULL,NULL,0,0,0},
};

//
// keystuff functions
//

char *ReadDefaultLayout(void)
{
	LONG		lError;
	HKEY		hKey;
	DWORD		dwDisp;
	DWORD		dwStrLen;
	static char szDefLayout[MAX_PATH];

	lError = RegCreateKeyEx (HKEY_LOCAL_MACHINE,REGKEY_CONFIG,0, "", REG_OPTION_NON_VOLATILE,
		KEY_ALL_ACCESS,NULL, &hKey, &dwDisp);

	dwStrLen = MAX_PATH;
	lError = RegQueryValueEx (hKey, REGKEY_KEYLAYOUT, 0, NULL, (BYTE *)szDefLayout, &dwStrLen);
	if (lError!=ERROR_SUCCESS)
		*szDefLayout = 0;

	RegCloseKey (hKey);

	return szDefLayout;
}


VKLOOKUP *GetVkLookup(void)
{
	switch (g_iLanguageId)
	{
		case MAKELANGID (LANG_GERMAN, SUBLANG_GERMAN):
			return vkLookup_ger;

		case MAKELANGID (LANG_FRENCH, SUBLANG_FRENCH):
			return vkLookup_fre;
	}

	return vkLookup_eng;
}


BOOL KeyIsSystemEnabled (void)
{
	return gbKeySystemActive;
}


void KeyEnableSystem (BOOL bEnable)
{
	gbKeySystemActive = bEnable;
}


void KeyClearAllDebounce(void)
{
	if (!gpCurrentLayout) return;

	for (KEYASSIGN *p=gpCurrentLayout->pKeys; p<&gpCurrentLayout->pKeys[gpCurrentLayout->dwCount]; p++)
		p->dwFlags &= ~KEYASSIGNF_DEBOUNCE;
}


VKLOOKUP *KeyFriendlyToVkCode(char *pszFriendlyName)
{
	VKLOOKUP *p = GetVkLookup();

	while (p->pszFriendlyName)
	{
		if (!stricmp(pszFriendlyName,p->pszFriendlyName))
			return p;
		p++;
	}

	return NULL;
}


KEYBOARDMAP *KeyFriendlyToFunction(char *pszFriendlyName)
{
	KEYBOARDMAP *pKy = keyMap;

	while (pKy->pszFriendlyName)
	{
		if (!stricmp(pKy->pszFriendlyName,pszFriendlyName))
			return pKy;
		pKy++;
	}
	return NULL;
}


DWORD KeyAssignKey(char *pszSection, VKLOOKUP *pVk, KEYASSIGN *pKey)
{
	static char szBuff[KEYBUFFSIZE];
	// TODO: check for duplicates, return 0 if dups

	pKey->vkCode = pVk->vkCode;
	pKey->wFlags = pVk->wFlags;
	pKey->dwExtraCode = pVk->dwExtraCode;
	pKey->pKeyList = NULL;
	pKey->nKeyCount = 0;
	pKey->dwFlags = 0;
	pKey->pfnOverrideFn = NULL;

	GetPrivateProfileString(pszSection,pVk->pszFriendlyName,"",szBuff,KEYBUFFSIZE,GetFullIniPathName());

	if (*szBuff)
	{
		DWORD dwCount;
		KEYBOARDMAP *pKy;
		char *p;

		dwCount = 0;

		_cleanup_string(szBuff);
		// parse szBuff for number of functions
		p = szBuff;
		while (*p)
		{
			dwCount++;
			p += strlen(p) + 1;
		}

		// allocate space for string
		pKey->pKeyList = (KEYBOARDMAP**)GlobalAlloc(GMEM_FIXED,dwCount * sizeof(DWORD));

		// do second pass adding functions
		p = szBuff;
		while (*p)
		{
			pKy = KeyFriendlyToFunction(p);
			if (pKy)
			{
				pKey->pKeyList[pKey->nKeyCount] = pKy;
				pKey->nKeyCount++;
			}
			p += strlen(p) + 1;
		}

		if (!pKey->nKeyCount)
		{
			GlobalFree((HGLOBAL)pKey->pKeyList);
			pKey->pKeyList = NULL;
		}
	}

	return pKey->nKeyCount;
}


void KeyFreeAssignments(KEYLAYOUT *pKeyLayout)
{
	if (!pKeyLayout->pKeys)
		return;

	for (KEYASSIGN *p=pKeyLayout->pKeys; p<&pKeyLayout->pKeys[pKeyLayout->dwCount]; p++)
	{
		GlobalFree((HGLOBAL)p->pKeyList);
		p->pKeyList = NULL;
	}

	GlobalFree((HGLOBAL)pKeyLayout->pKeys);
	pKeyLayout->dwCount = 0;
	pKeyLayout->pKeys = NULL;
}


char *GetFullIniPathName(void)
{
	static char szKeyIniName[MAX_PATH];
	extern char g_szExePath[260];
	char tm[MAX_PATH];

	switch (g_iLanguageId)
	{
		case MAKELANGID (LANG_GERMAN, SUBLANG_GERMAN):
			strcpy(tm,KEYINIFILE_G);
			break;

		case MAKELANGID (LANG_FRENCH, SUBLANG_FRENCH):
			strcpy(tm,KEYINIFILE_F);
			break;

		default:
			strcpy(tm,KEYINIFILE);
			break;
	}

	if (pszOverridePath)
		wsprintf(szKeyIniName,"%s\\%s",pszOverridePath,tm);
	else
		wsprintf(szKeyIniName,"%s\\%s",g_szExePath,tm);
	return szKeyIniName;
}


char *GetGamePlayLang(int nGamePlay)
{
	switch (g_iLanguageId)
	{
		case MAKELANGID (LANG_GERMAN, SUBLANG_GERMAN):
			return "VORGABE";
			break;

		case MAKELANGID (LANG_FRENCH, SUBLANG_FRENCH):
			return "DEFAULT";
			break;

		default:
			return "DEFAULT";
	}
}


DWORD InitDefaultKeyAssignments(void)
{
	char szLayout[MAX_PATH];
	DWORD dwCount=0;
	char *p;
	BYTE keyState[256];

	// Turn NUMLOCK on
	GetKeyboardState((LPBYTE)&keyState);
	keyState[VK_NUMLOCK] |= 1;
	SetKeyboardState((LPBYTE)&keyState);

	strcpy(szLayout,ReadDefaultLayout());

	gbKeySystemActive = TRUE;

	// set layout based on registry entry
	if (*szLayout)
	{
		dwCount = KeyAllocateAssignments(szLayout,&keyLayout);
		if (dwCount)
		{
			KeySetDefaultLayout(&keyLayout);
			KeyClearAllDebounce();
			if (dwCount)
				return dwCount;
		}
	}

	// Check the playstyle setting, for Expert or Casual mode
	LONG	lError;
	HKEY	hKey;
	DWORD	dwDisp;
	DWORD	dwStrLen;
	int		nGamePlay = 1;

	lError = RegCreateKeyEx (HKEY_LOCAL_MACHINE, REGKEY_CONFIG, 0, "", REG_OPTION_NON_VOLATILE, KEY_ALL_ACCESS,NULL, &hKey, &dwDisp);
	if (lError==ERROR_SUCCESS)
	{
		dwStrLen = sizeof (nGamePlay);
		lError = RegQueryValueEx (hKey, REGKEY_KEYPLAYSTYLE, 0, NULL, (BYTE *)&nGamePlay, &dwStrLen);
		RegCloseKey (hKey);
	}

	char *ps = GetGamePlayLang(nGamePlay);

	// try reading the CASUAL/EXPERT section in the F18KEYS.INI
	dwCount = KeyAllocateAssignments(ps,&keyLayout);
	if (dwCount)
	{
		KeySetDefaultLayout(&keyLayout);
		KeyClearAllDebounce();
		if (dwCount)
			return dwCount;
	}

	// if all else fails set default layout from CDROM
	if ((p = GetRegValue("CDROMPath"))!=NULL)
	{
		pszOverridePath = p;
		dwCount = KeyAllocateAssignments(ps,&keyLayout);
		pszOverridePath = NULL;
		if (dwCount)
		{
			KeySetDefaultLayout(&keyLayout);
			KeyClearAllDebounce();
		}
	}

	return dwCount;
}


void FreeDefaultKeyAssignments(void)
{
	KeyFreeAssignments(&keyLayout);
}


DWORD KeyAllocateAssignments(char *pszSection, KEYLAYOUT *pKeyLayout)
{
	DWORD dwSize,dwCount;
	static char szBuff[KEYBUFFSIZE];
	char *p;

	gbKeySystemActive = TRUE;

	pKeyLayout->dwCount = 0;
	pKeyLayout->pKeys = NULL;
	strcpy(pKeyLayout->szSectionName,pszSection);
	dwCount = 0;

	// get number of keyboard entries
	dwSize = GetPrivateProfileString(pszSection,NULL,"",szBuff,KEYBUFFSIZE,GetFullIniPathName());
	p = szBuff;
	while (*p)
	{
		dwCount++;
		p += strlen(p) + 1;
	}

	if (dwCount)
	{
		KEYASSIGN *pWalker;
		VKLOOKUP *pVk;

		// allocate key info space
		pKeyLayout->pKeys = (KEYASSIGN*)GlobalAlloc(GMEM_FIXED,dwCount * sizeof(KEYASSIGN));
		if (!pKeyLayout->pKeys) return 0;

		pWalker = pKeyLayout->pKeys;
		p = szBuff;

		// do second pass creating key mappings
		while (*p)
		{
			// check for valid code
			pVk = KeyFriendlyToVkCode(p);
			if (pVk && KeyAssignKey(pszSection, pVk, pWalker))
			{
				pKeyLayout->dwCount++;
				pWalker++;
			}
			p += strlen(p) + 1;
		}

		if (!pKeyLayout->dwCount)
		{
			GlobalFree((HGLOBAL)pKeyLayout->pKeys);
			pKeyLayout->pKeys = NULL;
		}
	}

	return pKeyLayout->dwCount;
}


void KeySetDefaultLayout(KEYLAYOUT *pLayout)
{
	gpCurrentLayout = pLayout;
	KeyClearAllDebounce();
}


BOOL KeyScanButtonLayout(void)
{
	if (!gpCurrentLayout || !gbKeySystemActive)
		return FALSE;

	VKCODE vk;
	KEYBOARDMAP *pkm;
	BOOL bDidProcess = FALSE;

	// do basic linear search for a key code, only for non-keyboard types only
	// also check for debounced inputs
	for (KEYASSIGN *p=gpCurrentLayout->pKeys; p<&gpCurrentLayout->pKeys[gpCurrentLayout->dwCount]; p++)
	{
		vk.wFlags = p->wFlags;
		vk.vkCode = p->vkCode;
		vk.dwExtraCode = p->dwExtraCode;

		if (p->wFlags!=LOOKF_KEYSTROKE)
		{
			if (!(p->dwFlags & (KEYASSIGNF_DEBOUNCE|KEYASSIGNF_DISABLE)) && GetVkStatus(vk))
			{
				// do all functions
				for (int i=0; i<p->nKeyCount; i++)
				{
					pkm = p->pKeyList[i];
					if (pkm->pfnKeyFunction && (!SimPause || (pkm->dwFlags & KEYF_ALLOW_PAUSE)))
					{
						if (!(pkm->dwFlags & KEYF_REPEAT))
							p->dwFlags |= KEYASSIGNF_DEBOUNCE;

						gpLastMap = p->pKeyList[i];
						p->pKeyList[i]->pfnKeyFunction(vk);
						bDidProcess = TRUE;
					}
				}
			}
		}

		if ((p->dwFlags & KEYASSIGNF_DEBOUNCE) && !GetVkStatus(vk))
			p->dwFlags &= ~KEYASSIGNF_DEBOUNCE;
	}
	GotExecutedKey = FALSE;

	return bDidProcess;
}

BOOL KeyScanButtonLayoutForEndMenu(void)
{
	if (!gpCurrentLayout || !gbKeySystemActive)
		return FALSE;

	VKCODE vk;
	KEYBOARDMAP *pkm;
	BOOL bDidProcess = FALSE;
	char keys[3];
	int tries;

 	if (!GotExecutedKey)
	{
		keys[0] = VK_RETURN;
		keys[2] = 'N';

		switch(PRIMARYLANGID(g_iLanguageId))
		{
			case LANG_ENGLISH:
				keys[1] = 'Y';
				break;

			case LANG_GERMAN:
				keys[1] = 'J';
				break;

			case LANG_FRENCH:
				keys[1] = 'O';
				break;
		}

		dwPlayerEndGameResponse = EG_NO_ANSWER;
		vk.wFlags = LOOKF_KEYSTROKE;
		vk.dwExtraCode = 0;

		tries = 0;
		while((tries < 3) && (dwPlayerEndGameResponse == EG_NO_ANSWER))
		{
			vk.vkCode = keys[tries];
			if (GetVkStatus(vk))
				if (tries == 2)
					dwPlayerEndGameResponse = EG_WANTS_STAY;
				else
					dwPlayerEndGameResponse = EG_WANTS_OUT;
			else
				tries++;
		}

	}

	GotExecutedKey = FALSE;

	// do basic linear search for a key code, only for non-keyboard types only
	// also check for debounced inputs
	for (KEYASSIGN *p=gpCurrentLayout->pKeys; p<&gpCurrentLayout->pKeys[gpCurrentLayout->dwCount]; p++)
	{
		vk.vkCode = p->vkCode;
		vk.dwExtraCode = p->dwExtraCode;

		if (p->wFlags!=LOOKF_KEYSTROKE)
		{
			if (!(p->dwFlags & (KEYASSIGNF_DEBOUNCE|KEYASSIGNF_DISABLE)) && GetVkStatus(vk))
			{
				// do all functions
				for (int i=0; i<p->nKeyCount; i++)
				{
					pkm = p->pKeyList[i];
					if (pkm->pfnKeyFunction && (!SimPause || (pkm->dwFlags & KEYF_ALLOW_PAUSE)))
					{
						if (!(pkm->dwFlags & KEYF_REPEAT))
							p->dwFlags |= KEYASSIGNF_DEBOUNCE;

						gpLastMap = p->pKeyList[i];
//						p->pKeyList[i]->pfnKeyFunction(vk);
						bDidProcess = TRUE;
					}
				}
			}
		}

		if ((p->dwFlags & KEYASSIGNF_DEBOUNCE) && !GetVkStatus(vk))
			p->dwFlags &= ~KEYASSIGNF_DEBOUNCE;
	}

	return bDidProcess;
}



BOOL GetVkStatus(VKCODE vk)
{
	BOOL bOk;

	if (XmitChannel || !gbKeySystemActive) return FALSE;

	if (!vk.vkCode && vk.wFlags!=LOOKF_JOYHAT1 && vk.wFlags!=LOOKF_JOYHAT2)
		return FALSE;

	switch (vk.wFlags)
	{
		case LOOKF_KEYSTROKE:
			bOk = (GetAsyncKeyState(vk.vkCode)<0);
			break;

		case LOOKF_JOY1:
		case LOOKF_JOY2:
			bOk = ((vk.vkCode & JoyInfoEx1.dwButtons) != 0);
			break;

		case LOOKF_JOYHAT1:
		case LOOKF_JOYHAT2:
			bOk = (vk.vkCode==JoyInfoEx1.dwPOV);
			break;
	}

	KEYASSIGN ka;

	ka.vkCode = vk.vkCode;
	ka.wFlags = vk.wFlags;
	ka.dwExtraCode = vk.dwExtraCode;

	bOk = bOk && KeyOkExtraCode(&ka);

	return bOk;
}


BOOL KeyOkExtraCode(KEYASSIGN *p)
{
	BOOL bExtraCode,bAlt,bShift,bCtrl;
	BOOL bOk = FALSE;

	if(iKeyboardOpt != 1)
	{
		bShift = GetKeyState(VK_SHIFT)<0;
		bCtrl = GetKeyState(VK_CONTROL)<0;
		bAlt = GetKeyState(VK_MENU)<0;
	}
	else
	{
		bShift = GetAsyncKeyState(VK_SHIFT)<0;
		bCtrl = GetAsyncKeyState(VK_CONTROL)<0;
		bAlt = GetAsyncKeyState(VK_MENU)<0;
	}

	bExtraCode = bAlt || bShift || bCtrl;

	if (!p->dwExtraCode && !bExtraCode)
		bOk = TRUE;
	else
	if (bExtraCode)
	{
		switch (p->dwExtraCode)
		{
			case VK_MENU:
				bOk = (!bCtrl && !bShift);
				break;

			case VK_CONTROL:
				bOk = (!bAlt && !bShift);
				break;

			case VK_SHIFT:
				bOk = (!bAlt && !bCtrl);
				break;
		}
	}
	return bOk;
}


VKLOOKUP * KeyFunctionNameToVkCode(char *pszFunctionName)
{
	KEYBOARDMAP *pkm;

	if (!gpCurrentLayout) return NULL;

	for (KEYASSIGN *p=gpCurrentLayout->pKeys; p<&gpCurrentLayout->pKeys[gpCurrentLayout->dwCount]; p++)
	{
		for (int i=0; i<p->nKeyCount; i++)
		{
			pkm = p->pKeyList[i];
			if (!stricmp(pkm->pszFriendlyName,pszFunctionName))
			{
				VKLOOKUP *q = GetVkLookup();

				while (q->pszFriendlyName)
				{
					if (p->vkCode == q->vkCode && p->wFlags == q->wFlags && p->dwExtraCode == q->dwExtraCode)
						return q;

					q++;
				}
			}
		}
	}

	return NULL;
}


BOOL KeyEnableKey(char *pszKeyFriendlyName, BOOL bEnable)
{
	VKLOOKUP *pVk;

	pVk = KeyFriendlyToVkCode(pszKeyFriendlyName);

	if (pVk)
	{
		for (KEYASSIGN *p=gpCurrentLayout->pKeys; p<&gpCurrentLayout->pKeys[gpCurrentLayout->dwCount]; p++)
		{
			if (p->vkCode==pVk->vkCode && p->wFlags==pVk->wFlags && p->dwExtraCode==pVk->dwExtraCode)
			{
				if (bEnable)
					p->dwFlags &= ~KEYASSIGNF_DISABLE;
				else
					p->dwFlags |= KEYASSIGNF_DISABLE;
				return TRUE;
			}
		}
	}

	return FALSE;
}



BOOL KeyExcecuteKey(LONG vkCode)
{
	KEYBOARDMAP *pkm;
	VKCODE vk;

	if (!gpCurrentLayout || !gbKeySystemActive)
		return FALSE;

	if (iEndGameState)
	{
		char keys[3];
		int tries;

		keys[0] = VK_RETURN;
		keys[2] = 'N';

		switch(PRIMARYLANGID(g_iLanguageId))
		{
			case LANG_ENGLISH:
				keys[1] = 'Y';
				break;

			case LANG_GERMAN:
				keys[1] = 'J';
				break;

			case LANG_FRENCH:
				keys[1] = 'O';
				break;
		}

		vk.wFlags = LOOKF_KEYSTROKE;
		vk.dwExtraCode = 0;

		tries = 0;
		while((tries < 3) && (!GotExecutedKey))
		{
			if (vkCode == (LONG)keys[tries])
			{
				if (tries == 2)
					dwPlayerEndGameResponse = EG_WANTS_STAY;
				else
					dwPlayerEndGameResponse = EG_WANTS_OUT;
 				GotExecutedKey = TRUE;
			}
			else
				tries++;
		}
	}
	else
		GotExecutedKey = FALSE;


	// do basic linear search for a key code, for only KEYSTROKES types only
	for (KEYASSIGN *p=gpCurrentLayout->pKeys; p<&gpCurrentLayout->pKeys[gpCurrentLayout->dwCount]; p++)
	{
		if (p->wFlags==LOOKF_KEYSTROKE && p->vkCode==vkCode && !(p->dwFlags & (KEYASSIGNF_DEBOUNCE|KEYASSIGNF_DISABLE)))
		{
			if (KeyOkExtraCode(p))
			{
				// check if this key has a override
				if (p->pfnOverrideFn)
				{
					ZeroMemory( &vk, sizeof( vk));
					if(!iEndGameState)
						p->pfnOverrideFn(vk);
				}
				else
				{
					// do all assigned functions
					for (int i=0; i<p->nKeyCount; i++)
					{
						pkm = p->pKeyList[i];
						if (pkm->pfnKeyFunction && (!SimPause || (pkm->dwFlags & KEYF_ALLOW_PAUSE)))
						{
							vk.vkCode = p->vkCode;
							vk.wFlags = p->wFlags;
							vk.dwExtraCode = p->dwExtraCode;

							if (!(pkm->dwFlags & KEYF_REPEAT))
								p->dwFlags |= KEYASSIGNF_DEBOUNCE;

							gpLastMap = p->pKeyList[i];
							if(!iEndGameState)
								p->pKeyList[i]->pfnKeyFunction(vk);
						}
					}
				}

				return TRUE;
			}
		}
	}
	return FALSE;
}

//
// keymisc functions
//

void KeySysMessageKey(int value)
{
	if (gpLastMap && gpLastMap->dwSysMsgID)
	{
		char szMsg[MAX_PATH];

		*szMsg = NULL;

		if (KeyGetKeyMessage(gpLastMap->dwSysMsgID,szMsg,value) && *szMsg)
		{
			if(gpLastMap->dwSysMsgID == KSYS_PAUSE)
			{
				AICAddAIRadioMsgs(szMsg, -2);
			}
			else
			{
				AICAddAIRadioMsgs(szMsg, -1);
			}
		}
	}
}

//
// misc functions
//

static void _cleanup_string(char *szString)
{
	static char szBuff[KEYBUFFSIZE];
	char *p,*q;

	p = szString;
	q = szBuff;

	while (*p)
	{
		if (isalnum(*p) || *p==';' || *p=='_')
		{
			*q = (*p==';') ? 0 : *p;
			q++;
		}
		p++;
	}
	*q = 0;
	*(q+1) = 0;
	memcpy(szString,szBuff, q - szBuff + 3);
}